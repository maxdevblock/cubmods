
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cubmods package &#8212; CUBmods 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cubmods';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="cubmods" href="modules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">CUBmods 0.0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="manual.html">
    Manual
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="modules.html">
    cubmods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="manual.html">
    Manual
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="modules.html">
    cubmods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">cubmods package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="modules.html" class="nav-link">cubmods</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">cubmods package</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cubmods-package">
<h1>cubmods package<a class="headerlink" href="#cubmods-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-cubmods.cub">
<span id="cubmods-cub-module"></span><h2>cubmods.cub module<a class="headerlink" href="#module-cubmods.cub" title="Link to this heading">#</a></h2>
<p id="cub00-module">CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial).</p>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB model family.</p>
</div></blockquote>
</section>
<section id="manual-examples-and-references">
<h3>Manual, Examples and References:<a class="headerlink" href="#manual-examples-and-references" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>See the <a class="reference external" href="manual.html#cub-without-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="list-of-todos">
<h3>List of TODOs:<a class="headerlink" href="#list-of-todos" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="credits">
<h3>Credits<a class="headerlink" href="#credits" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="classes-and-functions">
<h3>Classes and Functions<a class="headerlink" href="#classes-and-functions" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">CUBresCUB00</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub.CUBresCUB00.plot" title="cubmods.cub.CUBresCUB00.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub.CUBresCUB00.plot_confell" title="cubmods.cub.CUBresCUB00.plot_confell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_confell</span></code></a>([figsize, ci, equal, ...])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic confidence ellipse.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub.CUBresCUB00.plot_ordinal" title="cubmods.cub.CUBresCUB00.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, kind, ax, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability distribution and, if provided, probability distribution of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00.plot_confell">
<span class="sig-name descname"><span class="pre">plot_confell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00.plot_confell" title="Link to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic confidence ellipse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>equal</strong> (<em>bool</em>) – if the plot must have equal aspect</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability distribution and,
if provided, probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.cmf" title="Link to this definition">#</a></dt>
<dd><p>Cumulative probability of a specified CUB model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \leq r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of the CMF for the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.gini">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">gini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.gini" title="Link to this definition">#</a></dt>
<dd><p>The Gini index of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Gini index of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary estimators for CUB models without covariates.</p>
<p>Computes preliminary parameter estimates of a CUB model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of the absolute frequencies of given ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi^{(0)}, \xi^{(0)})\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.laakso">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">laakso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.laakso" title="Link to this definition">#</a></dt>
<dd><p>The Laakso index of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Laakso index of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.loglik" title="Link to this definition">#</a></dt>
<dd><p>Compute the log-likelihood function of a CUB model without 
covariates for a given absolute frequency distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.mean" title="Link to this definition">#</a></dt>
<dd><p>Expected value of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.median">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.median" title="Link to this definition">#</a></dt>
<dd><p>The median of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the median of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUB models without covariates.</p>
<p>Function to estimate and validate a CUB model without covariates for given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUB00</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.pmf" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUB model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution of a CUB model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>r</strong> (<em>int</em>) – ordinal value (must be <span class="math notranslate nohighlight">\(1 \leq r \leq m\)</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.skew">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.skew" title="Link to this definition">#</a></dt>
<dd><p>Skewness normalized <span class="math notranslate nohighlight">\(\eta\)</span> index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the skewness of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.std">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.std" title="Link to this definition">#</a></dt>
<dd><p>Standard deviation of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the standard deviation of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.var" title="Link to this definition">#</a></dt>
<dd><p>Variance of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordinal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.varcov" title="Link to this definition">#</a></dt>
<dd><p>Compute the variance-covariance matrix of parameter 
estimates of a CUB model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>ordinal</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cub_0w">
<span id="cubmods-cub-0w-module"></span><h2>cubmods.cub_0w module<a class="headerlink" href="#module-cubmods.cub_0w" title="Link to this heading">#</a></h2>
<p id="cub0w-module">CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial) with covariates for the feeling component.</p>
<section id="id1">
<h3>Description:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_0W model family.</p>
</div></blockquote>
</section>
<section id="id2">
<h3>Manual, Examples and References:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cub-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id3">
<h3>List of TODOs:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id4">
<h3>Credits<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id5">
<h3>Classes and Functions<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub_0w.CUBresCUB0W">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">CUBresCUB0W</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.CUBresCUB0W" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub_0w.CUBresCUB0W.plot" title="cubmods.cub_0w.CUBresCUB0W.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub_0w.CUBresCUB0W.plot_ordinal" title="cubmods.cub_0w.CUBresCUB0W.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_0w.CUBresCUB0W.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.CUBresCUB0W.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_0w.CUBresCUB0W.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.CUBresCUB0W.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model with covariates for
the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None;
it must be <span class="math notranslate nohighlight">\(\neq 0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.effe01">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">effe01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.effe01" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUB models
with covariates for the feeling component.</p>
<p>Compute the opposite of the scalar function that is maximized when running 
the E-M algorithm for CUB models with covariates for the feeling parameter.</p>
<p>It is called as an argument for <code class="docutils literal notranslate"><span class="pre">minimize</span></code> within CUB function for models with covariates for
feeling or for both feeling and uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>esterno01</strong> – a matrix binding together: the vector <span class="math notranslate nohighlight">\(\pmb\tau\)</span> of the posterior probabilities
that each observation has been generated by the first component distribution of the mixture, 
the ordinal data <span class="math notranslate nohighlight">\(\pmb r\)</span> and the matrix <span class="math notranslate nohighlight">\(\pmb w\)</span> of the selected covariates 
accounting for an intercept term</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the inconplete log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.init_gamma">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">init_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.init_gamma" title="Link to this definition">#</a></dt>
<dd><p>Preliminary parameter estimates of a CUB model with covariates for the feeling component.</p>
<p>Compute preliminary parameter estimates for the feeling component of a CUB model 
fitted to ordinal responses.
These estimates are set as initial values for parameters to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array <span class="math notranslate nohighlight">\(\pmb\gamma^{(0)}\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUB model with covariates for the feeling component</p>
<p>Compute the log-likelihood function of a CUB model fitting ordinal data, with
covariates for explaining the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUB models with covariates for the feeling component.</p>
<p>Function to estimate and validate a CUB model for given ordinal responses, with covariates for
explaining the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUB0W</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUB model 
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUB model 
with covariates for the feeling component.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a CUB model with covariates for the feeling component
given an observed sample</p>
<p>Compute the probability distribution of a CUB model with covariates
for the feeling component, given an observed sample.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of CUB models with covariates for the feeling component</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model
with covariates for the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cub_y0">
<span id="cubmods-cub-y0-module"></span><h2>cubmods.cub_y0 module<a class="headerlink" href="#module-cubmods.cub_y0" title="Link to this heading">#</a></h2>
<p id="cuby0-module">CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial) with covariates for the uncertainty component.</p>
<section id="id6">
<h3>Description:<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_Y0 model family.</p>
</div></blockquote>
</section>
<section id="id7">
<h3>Manual, Examples and References:<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cub-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id8">
<h3>List of TODOs:<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id9">
<h3>Credits<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id10">
<h3>Classes and Functions<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub_y0.CUBresCUBY0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBY0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.CUBresCUBY0" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub_y0.CUBresCUBY0.plot" title="cubmods.cub_y0.CUBresCUBY0.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub_y0.CUBresCUBY0.plot_ordinal" title="cubmods.cub_y0.CUBresCUBY0.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_y0.CUBresCUBY0.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.CUBresCUBY0.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_y0.CUBresCUBY0.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.CUBresCUBY0.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model with covariates for
the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None;
it must be <span class="math notranslate nohighlight">\(\neq 0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.effe10">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">effe10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.effe10" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUB models.</p>
<p>Compute the opposite of the scalar function that is maximized when running
the E-M algorithm for CUB models with covariates for the uncertainty parameter.</p>
<dl class="simple">
<dt>It is called as an argument for optim within CUB function for models with covariates for</dt><dd><p>uncertainty or for both feeling and uncertainty.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>esterno10</strong> – A matrix binding together: the matrix <span class="math notranslate nohighlight">\(\pmb y\)</span> of the selected covariates  
(accounting for an intercept term) and a vector <span class="math notranslate nohighlight">\(\tau\)</span> (whose length equals the number of observations) 
of the posterior probabilities that each observation has been generated by the first component 
distribution of the mixture</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the inconplete log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUB model with covariates for the uncertainty component</p>
<p>Compute the log-likelihood function of a CUB model fitting ordinal responses with covariates 
for explaining the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUB models with covariates for the uncertainty component.</p>
<p>Estimate and validate a CUB model for given ordinal responses, with covariates for explaining 
the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBY0</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUB model 
with covariates.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUB model 
with covariates.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a CUB model with covariates for the uncertainty component
given an observed sample</p>
<p>Compute the probability distribution of a CUB model with covariates
for the feeling component, given an observed sample.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of CUB model with covariates for the uncertainty parameter.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with 
covariates for the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cub_yw">
<span id="cubmods-cub-yw-module"></span><h2>cubmods.cub_yw module<a class="headerlink" href="#module-cubmods.cub_yw" title="Link to this heading">#</a></h2>
<p id="cubyw-module">CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial) with covariates
for both feeling and uncertainty.</p>
<section id="id11">
<h3>Description:<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_YW model family.</p>
</div></blockquote>
</section>
<section id="id12">
<h3>Manual, Examples and References:<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cub-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id13">
<h3>List of TODOs:<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id14">
<h3>Credits<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id15">
<h3>Classes and Functions<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub_yw.CUBresCUBYW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBYW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.CUBresCUBYW" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>“Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub_yw.CUBresCUBYW.plot" title="cubmods.cub_yw.CUBresCUBYW.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub_yw.CUBresCUBYW.plot_ordinal" title="cubmods.cub_yw.CUBresCUBYW.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_yw.CUBresCUBYW.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.CUBresCUBYW.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_yw.CUBresCUBYW.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.CUBresCUBYW.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model with covariates for
both feeling and uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUB model with covariates for both feeling and uncertainty.</p>
<p>Compute the log-likelihood function of a CUB model fitting ordinal data
with covariates for explaining both the feeling and the uncertainty components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUB models with covariates for both the uncertainty and the feeling components.</p>
<p>Estimate and validate a CUB model for given ordinal responses, with covariates for explaining both the
feeling and the uncertainty components by means of logistic transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBYW</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUB model 
with covariates for both feeling and uncertainty.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUB model 
with covariates for both feeling and uncertainty.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a CUB model with covariates for both feeling and uncertainty.</p>
<p>Compute the probability distribution of a CUB model with covariates for both the feeling 
and the uncertainty components.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of a CUB model with covariates for both uncertainty and feeling.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with covariates for
both the uncertainty and the feeling components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cube">
<span id="cubmods-cube-module"></span><h2>cubmods.cube module<a class="headerlink" href="#module-cubmods.cube" title="Link to this heading">#</a></h2>
<p id="cube000-module">CUB models in Python.
Module for CUBE (Combination of Uniform
and Beta-Binomial).</p>
<section id="id16">
<h3>Description:<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBE model family.</p>
</div></blockquote>
</section>
<section id="id17">
<h3>Manual, Examples and References:<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cube-without-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id18">
<h3>List of TODOs:<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: adjust 3d plots legend</p></li>
</ul>
</div></blockquote>
</section>
<section id="id19">
<h3>Credits<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id20">
<h3>Classes and Functions<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube.CUBresCUBE.plot" title="cubmods.cube.CUBresCUBE.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, confell, test3, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cube.CUBresCUBE.plot3d" title="cubmods.cube.CUBresCUBE.plot3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot3d</span></code></a>(ax[, ci, magnified])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic confidence ellipsoid with its projections.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube.CUBresCUBE.plot_ordinal" title="cubmods.cube.CUBresCUBE.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability distribution and, if provided, probability distribution of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipsoid</p></li>
<li><p><strong>confell</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to False</p></li>
<li><p><strong>test3</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to True</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE.plot3d" title="Link to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic confidence ellipsoid with its projections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipsoid</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability distribution and,
if provided, probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.betar">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">betar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.betar" title="Link to this definition">#</a></dt>
<dd><p>Beta-Binomial distribution.</p>
<p>Return the Beta-Binomial distribution with given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of length <span class="math notranslate nohighlight">\(m\)</span> of the Beta-Binomial distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.cmf" title="Link to this definition">#</a></dt>
<dd><p>Cumulative probability of a specified CUBE model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \leq r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of length <span class="math notranslate nohighlight">\(m\)</span> of the cumulative probability of a CUBE model without covariates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.effecube">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">effecube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.effecube" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models without covariates.</p>
<p>Define the opposite of the scalar function that is maximized when running the E-M 
algorithm for CUBE models without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>array</em><em> of </em><em>float</em>) – array of initial estimates for the feeling and the overdispersion parameters</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – a column vector of length <span class="math notranslate nohighlight">\(m\)</span> containing the posterior
probabilities that each observed category has been generated by the first component distribution 
of the mixture</p></li>
<li><p><strong>f</strong> (<em>array</em>) – array of the absolute frequencies of the observations</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the inconplete log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Naive estimates for CUBE models without covariates.</p>
<p>Compute naive parameter estimates of a CUBE model without covariates for given ordinal responses. 
These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi^{(0)}, \xi^{(0)}, \phi^{(0)})\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUBE model without covariates.</p>
<p>Compute the log-likelihood function of a CUBE model without covariates fitting 
the given absolute frequency distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.mean" title="Link to this definition">#</a></dt>
<dd><p>Mean of a CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUBE models without covariates.</p>
<p>Estimate and validate a CUBE model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBE</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.pmf" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUBE model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of length <span class="math notranslate nohighlight">\(m\)</span> of the distribution of a CUBE model without covariates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a CUBE model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>r</strong> (<em>int</em>) – ordinal response</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a CUBE model without covariates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.var" title="Link to this definition">#</a></dt>
<dd><p>Variance of a CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix for CUBE models based on the observed information matrix.</p>
<p>Compute the variance-covariance matrix of parameter estimates for a CUBE model without covariates 
as the inverse of the observed information matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUBE model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cube_0w0">
<span id="cubmods-cube-0w0-module"></span><h2>cubmods.cube_0w0 module<a class="headerlink" href="#module-cubmods.cube_0w0" title="Link to this heading">#</a></h2>
<p id="cube0w0-module">CUB models in Python.
Module for CUBE (Combination of Uniform
and Beta-Binomial) with covariates for the feeling component.</p>
<section id="id21">
<h3>Description:<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBE_0W0 model family.</p>
</div></blockquote>
</section>
<section id="id22">
<h3>Manual, Examples and References:<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cube-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id23">
<h3>List of TODOs:<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual and Examples</p></li>
<li><p>Remove unused imports</p></li>
</ul>
</div></blockquote>
</section>
<section id="id24">
<h3>Credits<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id25">
<h3>Classes and Functions<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cube_0w0.CUBresCUBE0W0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBE0W0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.CUBresCUBE0W0" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot" title="cubmods.cube_0w0.CUBresCUBE0W0.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal" title="cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_0w0.CUBresCUBE0W0.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.betabinomialxi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">betabinomialxi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xivett</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.betabinomialxi" title="Link to this definition">#</a></dt>
<dd><p>Beta-Binomial probabilities of ordinal responses, given feeling parameter for each observation.</p>
<p>Compute the Beta-Binomial probabilities of given ordinal responses, with feeling 
parameter specified for each observation, 
and with the same overdispersion parameter for all the responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em>) – array of ordinal responses. Missing values are not allowed: they should be preliminarily deleted</p></li>
<li><p><strong>xivett</strong> (<em>array</em>) – array of feeling parameters of the Beta-Binomial distribution for given ordinal responses</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of the same length as ordinal: each entry is the Beta-Binomial probability for the given observation 
for the corresponding feeling and overdispersion parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.effe" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates 
only for the feeling component.</p>
<p>Compute the opposite of the scalar function that is maximized when running the 
E-M algorithm for CUBE models with covariates only for the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of length equal to <code class="docutils literal notranslate"><span class="pre">W.index.size+3</span></code> whose entries are the initial parameters estimates</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>negative log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary estimates of parameters for CUBE models with covariates only for feeling.</p>
<p>Compute preliminary parameter estimates of a CUBE model with covariates only for feeling, given
ordinal responses. These estimates are set as initial values to start the corresponding E-M algorithm within the package.
Preliminary estimates for the uncertainty and the overdispersion parameters are computed by short runs of EM. 
As to the feeling component, it considers the nested CUB model with covariates and calls code{link{inibestgama}} to derive initial estimates for the coefficients
of the selected covariates for feeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for preliminary iterations</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates for preliminary iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi^{(0)}, \pmb \gamma^{(0)}, \phi^{(0)})\)</span>, where <span class="math notranslate nohighlight">\(\pi^{(0)}\)</span> is the initial 
estimate for the uncertainty parameter, 
<span class="math notranslate nohighlight">\(\pmb \gamma^{(0)}\)</span> is the vector of initial estimates for the feeling component (including an intercept 
term in the first entry),
and <span class="math notranslate nohighlight">\(\phi^{(0)}\)</span> is the initial estimate for the overdispersion parameter.</p>
</dd>
</dl>
<p>“rtype”: tuple</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of CUBE model with covariates only for feeling.</p>
<p>Compute the log-likelihood function of a CUBE model for ordinal data with subjects’ 
covariates only for feeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUBE models with covariates only for feeling</p>
<p>Estimate and validate a CUBE model for ordinal data, with covariates only for explaining the
feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for preliminary iterations</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates for preliminary iterations;
the informatio matrix (to compute the variance-covariance matrix) is approximated with <code class="docutils literal notranslate"><span class="pre">approx_hess()</span></code>
(see <code class="docutils literal notranslate"><span class="pre">statsmodels.tools.numdiff</span></code> for details)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBE0W0</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUB model 
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the average probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUBE model 
with covariates for feeling only.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a CUBE model with covariates for feeling.</p>
<p>Compute the probability distribution of a CUB model with covariates for both the feeling 
and the uncertainty components. Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.loglik()</span></code></p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cube_ywz">
<span id="cubmods-cube-ywz-module"></span><h2>cubmods.cube_ywz module<a class="headerlink" href="#module-cubmods.cube_ywz" title="Link to this heading">#</a></h2>
<p id="cubeywz-module">CUB models in Python.
Module for CUBE (Combination of Uniform
and Beta-Binomial) with covariates.</p>
<section id="id26">
<h3>Description:<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_YWZ model family.</p>
</div></blockquote>
</section>
<section id="id27">
<h3>Manual, Examples and References:<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cube-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id28">
<h3>List of TODOs:<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual and Examples</p></li>
</ul>
</div></blockquote>
</section>
<section id="id29">
<h3>Credits<a class="headerlink" href="#id29" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id30">
<h3>Classes and Functions<a class="headerlink" href="#id30" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cube_ywz.CUBresCUBEYWZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBEYWZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.CUBresCUBEYWZ" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot" title="cubmods.cube_ywz.CUBresCUBEYWZ.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal" title="cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_ywz.CUBresCUBEYWZ.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.Qdue">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">Qdue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tauno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.Qdue" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates.</p>
<p>Define the opposite of one of the two scalar functions that are maximized when running the E-M 
algorithm for CUBE models with covariates for feeling, uncertainty and overdispersion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of initial estimates of parameters for the feeling component and the overdispersion effect</p></li>
<li><p><strong>tauno</strong> (<em>array</em>) – the column vector of the posterior probabilities that each observed rating
has been generated by the distribution of the first component of the mixture</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.Quno">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">Quno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.Quno" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates.</p>
<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for CUBE models with covariates for feeling, uncertainty and overdispersion.</p>
<p>It is iteratively called as an argument of “optim” within CUBE function (with covariates) as  the function
to minimize to compute the maximum likelihood estimates for the feeling and the overdispersion components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>esterno1</strong> (<em>ndarray</em>) – matrix binding together the column vector of the posterior probabilities
that each observed rating has been generated by the first component distribution of the mixture, with the matrix 
<span class="math notranslate nohighlight">\(\pmb y\)</span> of explicative  variables for the uncertainty component, expanded with a unitary vector in the first column to 
consider also an intercept term</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.auxmat">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">auxmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.auxmat" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary matrix.</p>
<p>Returns an auxiliary matrix needed for computing the variance-covariance matrix of a CUBE model with covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>array</em><em> of </em><em>float</em>) – feeling parameters <span class="math notranslate nohighlight">\(\pmb\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>array</em><em> of </em><em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\pmb\phi\)</span></p></li>
<li><p><strong>a</strong><strong>,</strong><strong>b</strong><strong>,</strong><strong>c</strong><strong>,</strong><strong>d</strong><strong>,</strong><strong>e</strong> (<em>float</em>) – see the reference paper <span id="id31"><a class="reference internal" href="references.html#id14" title="Domenico Piccolo. Inferential issues on cube models with covariates. Communications in Statistics-Theory and Methods, 44(23):5023–5036, 2015.">Piccolo, 2015</a></span> for details</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.betabinomial">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">betabinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.betabinomial" title="Link to this definition">#</a></dt>
<dd><p>Beta-Binomial probabilities of ordinal responses, with feeling and overdispersion parameters
for each observation.</p>
<p>Compute the Beta-Binomial probabilities of ordinal responses, given feeling and overdispersion
parameters for each observation.</p>
<p>The Beta-Binomial distribution is the Binomial distribution in which the probability of success at
each trial is random and follows the Beta distribution. It is frequently used in Bayesian 
statistics, empirical Bayes methods and classical statistics as an overdispersed binomial distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of the same length as <code class="docutils literal notranslate"><span class="pre">sample</span></code>, containing the Beta-Binomial probabilities of each observation,
for the corresponding feeling and overdispersion parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary parameter estimates for CUBE models with covariates.</p>
<p>Compute preliminary parameter estimates for a CUBE model with covariates for all the three parameters. 
These estimates are set as initial values to start the E-M algorithm within maximum likelihood estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of covariates for the uncertainty component</p></li>
<li><p><strong>v</strong> (<em>int</em>) – number of covariates for the overdispersion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pmb \beta^{(0)}, \pmb \gamma^{(0)}, \pmb \alpha^{(0)})\)</span> of preliminary estimates of parameter vectors for 
<span class="math notranslate nohighlight">\(\pi = \pi(\pmb{\beta})\)</span>, ; xi=xi(pmb{gamma}),; phi=phi(pmb{alpha})` respectively, of a CUBE model with covariates for all the three
parameters. In details, they have length equal to <code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code>, <code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> and
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code>, respectively, to account for an intercept term for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUBE model with covariates.</p>
<p>Compute the log-likelihood function of a CUBE model for ordinal responses,
with covariates for explaining all the three parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUBE models with covariates.</p>
<p>Function to estimate and validate a CUBE model with 
explicative covariates for all the three parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBEYWZ</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUB model 
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the average probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUBE model 
with covariates.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of a CUBE model with covariates.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUBE model with covariates
for all the three parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion</p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cubsh">
<span id="cubmods-cubsh-module"></span><h2>cubmods.cubsh module<a class="headerlink" href="#module-cubmods.cubsh" title="Link to this heading">#</a></h2>
<p id="cubsh000-module">CUB models in Python.
Module for CUBSH (Combination of Uniform
and Binomial with Shelter Effect).</p>
<section id="id32">
<h3>Description:<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBSH model family.</p>
</div></blockquote>
</section>
<section id="id33">
<h3>Manual, Examples and References:<a class="headerlink" href="#id33" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cubsh-without-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id34">
<h3>List of TODOs:<a class="headerlink" href="#id34" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: fix 3d plots legend</p></li>
<li><p>TODO: test all <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">_*():</span></code> (optional functions)</p></li>
</ul>
</div></blockquote>
</section>
<section id="id35">
<h3>Credits<a class="headerlink" href="#id35" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id36">
<h3>Classes and Functions<a class="headerlink" href="#id36" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBSH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh.CUBresCUBSH.plot" title="cubmods.cubsh.CUBresCUBSH.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, confell, debug, test3, ...])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cubsh.CUBresCUBSH.plot3d" title="cubmods.cubsh.CUBresCUBSH.plot3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot3d</span></code></a>(ax[, ci, magnified])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic confidence ellipsoid with its projections.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh.CUBresCUBSH.plot_ordinal" title="cubmods.cubsh.CUBresCUBSH.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability distribution and, if provided, probability distribution of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipsoid</p></li>
<li><p><strong>confell</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to False</p></li>
<li><p><strong>test3</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to True</p></li>
<li><p><strong>debug</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to False</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot3d" title="Link to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic confidence ellipsoid with its projections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipsoid</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability distribution and,
if provided, probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.cmf" title="Link to this definition">#</a></dt>
<dd><p>Cumulative probability of a specified CUBSH model,
using alternative parametrization <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \leq r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the cumulative probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.cmf_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">cmf_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.cmf_delta" title="Link to this definition">#</a></dt>
<dd><p>Cumulative probability of a specified CUBSH model,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \leq r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the cumulative probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBSH model,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.draw2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">draw2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.draw2" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBSH model,
using alternative parametrization <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary estimators for CUBSH models.</p>
<p>Computes preliminary parameter estimates of a CUBSH model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of the absolute frequencies of given ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi_1^{(0)}, \pi_2^{(0)}, \xi^{(0)})\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood of a CUB model with shelter effect</p>
<p>Compute the log-likelihood of a CUB model with a shelter effect
for the given absolute frequency distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>f</strong> (<em>array</em>) – Vector of the absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likehood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.mean_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">mean_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.mean_delta" title="Link to this definition">#</a></dt>
<dd><p>Expected value of a specified CUBSH model,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUB models with a shelter effect</p>
<p>Estimate and validate a CUB model with a shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBSH</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
<dt class="field-even">Raise<span class="colon">:</span></dt>
<dd class="field-even"><p>Exception if <span class="math notranslate nohighlight">\(m \leq 4\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pi1pi2_to_pidelta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pi1pi2_to_pidelta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pi1pi2_to_pidelta" title="Link to this definition">#</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\((\pi, \delta)\)</span> from <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span></p>
<p><span class="math notranslate nohighlight">\(\pi = \dfrac{\pi_1}{\pi_1 + \pi_2}\)</span></p>
<p><span class="math notranslate nohighlight">\(\delta = 1 - \pi_1 - \pi_2\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi, \delta)\)</span> the parameters of 
uncertainty and shelter choice, respectively</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pidelta_to_pi1pi2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pidelta_to_pi1pi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pidelta_to_pi1pi2" title="Link to this definition">#</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span> from <span class="math notranslate nohighlight">\((\pi, \delta)\)</span></p>
<p><span class="math notranslate nohighlight">\(\pi_1 = (1 - \delta) \pi\)</span></p>
<p><span class="math notranslate nohighlight">\(\pi_2 = (1 - \delta)(1 - \pi)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span> the mixing coefficient of the shifted
Binomial and the Uniform components, respectively</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.plot_simplex">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">plot_simplex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi1pi2list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.plot_simplex" title="Link to this definition">#</a></dt>
<dd><p>Plot simplex of parameters of a CUBSH model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>see the reference <span id="id37"><a class="reference internal" href="references.html#id9" title="Maria Iannario. Modelling shelter choices in a class of mixture models for ordinal responses. Statistical Methods &amp; Applications, 21:1–22, 2012.">Iannario, 2012</a></span> for details</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>this function still needs several fixes</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi1pi2list</strong> (<em>list</em>) – list of <code class="docutils literal notranslate"><span class="pre">[pi1,</span> <span class="pre">pi2]</span></code> parameters</p></li>
<li><p><strong>ax</strong> – matplotlib axis</p></li>
<li><p><strong>fname</strong> – if provided, save the plot to <code class="docutils literal notranslate"><span class="pre">fname</span></code>, defaults to None</p></li>
<li><p><strong>fname</strong> – str</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pmf" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUBSH model,
using alternative parametrization <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pmf_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pmf_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pmf_delta" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUBSH model,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a CUBSH model without covariates,
using alternative parametrization <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>r</strong> (<em>int</em>) – ordinal response</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.proba_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">proba_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.proba_delta" title="Link to this definition">#</a></dt>
<dd><p>Probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a CUBSH model without covariates,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>r</strong> (<em>int</em>) – ordinal response</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.std_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">std_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.std_delta" title="Link to this definition">#</a></dt>
<dd><p>Standard deviation of a specified CUB model,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the standard deviation of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.var_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">var_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.var_delta" title="Link to this definition">#</a></dt>
<dd><p>Variance of a specified CUBSH model,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix for CUB models with shelter effect,
using alternative parametrization <span class="math notranslate nohighlight">\((\pi_1, \pi_2)\)</span>.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi1</strong> (<em>float</em>) – Mixing coefficient for the shifted Binomial component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_1\)</span></p></li>
<li><p><strong>pi2</strong> (<em>float</em>) – Mixing coefficient for the discrete Uniform component of the mixture distribution <span class="math notranslate nohighlight">\(\pi_2\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.varcov_pxd">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">varcov_pxd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">de</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.varcov_pxd" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix for CUB models with shelter effect,
using canonic parametrization <span class="math notranslate nohighlight">\((\pi, \delta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>de</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cubsh_ywx">
<span id="cubmods-cubsh-ywx-module"></span><h2>cubmods.cubsh_ywx module<a class="headerlink" href="#module-cubmods.cubsh_ywx" title="Link to this heading">#</a></h2>
<p id="cubshywx-module">CUB models in Python.
Module for CUBSH (Combination of Uniform
and Binomial with Shelter Effect) with covariates.</p>
<section id="id38">
<h3>Description:<a class="headerlink" href="#id38" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBSH_YWX model family.</p>
</div></blockquote>
</section>
<section id="id39">
<h3>Manual, Examples and References:<a class="headerlink" href="#id39" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cubsh-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id40">
<h3>List of TODOs:<a class="headerlink" href="#id40" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id41">
<h3>Credits<a class="headerlink" href="#id41" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id42">
<h3>Classes and Functions<a class="headerlink" href="#id42" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.CUBresCUBSHYWX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBSHYWX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot" title="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal" title="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.Q1">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">Q1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dati1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.Q1" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of GeCUB models.</p>
<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for GeCUB models with covariates for feeling, uncertainty and shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> (<em>array</em>) – array of initial estimates of parameters for the uncertainty component</p></li>
<li><p><strong>dati1</strong> (<em>ndarray</em><em> or </em><em>dataframe</em>) – auxiliary matrix</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of covariates for the uncertainty component</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.Q2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">Q2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dati2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.Q2" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of GeCUB models.</p>
<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for GeCUB models with covariates for feeling, uncertainty and shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> (<em>array</em>) – array of initial estimates of parameters for the feeling component</p></li>
<li><p><strong>dati2</strong> (<em>ndarray</em><em> or </em><em>dataframe</em>) – auxiliary matrix</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBSH model with covariates
(aka GeCUB model).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary estimators for CUBSH models with covariates.</p>
<p>Computes preliminary parameter estimates of a CUBSH model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of covariates for the uncertainty component</p></li>
<li><p><strong>s</strong> (<em>int</em>) – number of covariates for the shelter effect</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pmb \beta^{(0)}, \pmb \gamma^{(0)}, \pmb \omega^{(0)})\)</span> of preliminary estimates of parameter vectors for 
<span class="math notranslate nohighlight">\(\pi = \pi(\pmb{\beta})\)</span>, ; xi=xi(pmb{gamma}),; delta=delta(pmb{omega})` respectively, of a CUBSH model with covariates for all the three
parameters. In details, they have length equal to <code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code>, <code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> and
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code>, respectively, to account for an intercept term for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUBSH model with covariates.</p>
<p>Compute the log-likelihood function of a CUBE model for ordinal responses,
with covariates for explaining all the three parameters (GeCUB model).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUBSH models with covariates for all the components</p>
<p>Function to estimate and validate a CUBSH model for given ordinal responses, with covariates for
explaining all the components and the shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBSHYWZ</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUBSH model with covariates
(aka GeCUB model).</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUBSH model with covariates
(aka GeCUB model).</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a CUBSH model with covariates.</p>
<p>Compute the probability distribution of a CUBSH model with covariates.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.varcov" title="Link to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of a CUBSH model with covariates</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUBSH model with covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>beta</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cush">
<span id="cubmods-cush-module"></span><h2>cubmods.cush module<a class="headerlink" href="#module-cubmods.cush" title="Link to this heading">#</a></h2>
<p id="cush0-module">CUB models in Python.
Module for CUSH (Combination of Uniform
and Shelter effect).</p>
<section id="id43">
<h3>Description:<a class="headerlink" href="#id43" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH model family.</p>
</div></blockquote>
</section>
<section id="id44">
<h3>Manual, Examples and References:<a class="headerlink" href="#id44" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cush-without-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id45">
<h3>List of TODOs:<a class="headerlink" href="#id45" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: check and fix gini &amp; laakso</p></li>
</ul>
</div></blockquote>
</section>
<section id="id46">
<h3>Credits<a class="headerlink" href="#id46" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id47">
<h3>Classes and Functions<a class="headerlink" href="#id47" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush.CUBresCUSH.plot" title="cubmods.cush.CUBresCUSH.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cush.CUBresCUSH.plot_estim" title="cubmods.cush.CUBresCUSH.plot_estim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_estim</span></code></a>([ci, ax, magnified, figsize, saveas])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic standard error.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush.CUBresCUSH.plot_ordinal" title="cubmods.cush.CUBresCUSH.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, kind, ax, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability distribution and, if provided, probability distribution of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the standard error</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.plot_estim">
<span class="sig-name descname"><span class="pre">plot_estim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.plot_estim" title="Link to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic standard error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability distribution and,
if provided, probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.LRT">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">LRT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.LRT" title="Link to this definition">#</a></dt>
<dd><p>Likelihood Ratio Test between the CUSH model and
the null model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>fc</strong> (<em>float</em>) – relative frequency of the shelter category</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the value of the LRT</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUSH model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.gini">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">gini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.gini" title="Link to this definition">#</a></dt>
<dd><p>The Gini index of a specified CUSH model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Gini index of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.laakso">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">laakso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.laakso" title="Link to this definition">#</a></dt>
<dd><p>The Laakso index of a specified CUSH model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Laakso index of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function for a CUSH model without covariates</p>
<p>Compute the log-likelihood function for a CUSH model 
without covariate for the given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likehood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.mean" title="Link to this definition">#</a></dt>
<dd><p>Expected value of a specified CUSH model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUSH model without covariates.</p>
<p>Estimate and validate a CUSH model for given ordinal responses, without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>None</em>) – default to None; ensure compatibility with <code class="docutils literal notranslate"><span class="pre">gem.from_formula()</span></code></p></li>
<li><p><strong>tol</strong> (<em>None</em>) – default to None; ensure compatibility with <code class="docutils literal notranslate"><span class="pre">gem.from_formula()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUSH</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.pmf" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUSH model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.var" title="Link to this definition">#</a></dt>
<dd><p>Variance of a specified CUSH model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>delta</strong> (<em>float</em>) – shelter choice parameter <span class="math notranslate nohighlight">\(\delta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cush2">
<span id="cubmods-cush2-module"></span><h2>cubmods.cush2 module<a class="headerlink" href="#module-cubmods.cush2" title="Link to this heading">#</a></h2>
<p id="cush200-module">CUB models in Python.
Module for CUSH2 (Combination of Uniform
and 2 Shelter Choices).</p>
<section id="id48">
<h3>Description:<a class="headerlink" href="#id48" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH2 model family.</p>
</div></blockquote>
</section>
<section id="id49">
<h3>Manual, Examples and References:<a class="headerlink" href="#id49" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cush2-without-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id50">
<h3>List of TODOs:<a class="headerlink" href="#id50" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id51">
<h3>Credits<a class="headerlink" href="#id51" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id52">
<h3>Classes and Functions<a class="headerlink" href="#id52" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2.CUBresCUSH2.plot" title="cubmods.cush2.CUBresCUSH2.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cush2.CUBresCUSH2.plot_ordinal" title="cubmods.cush2.CUBresCUSH2.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability distribution and, if provided, probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2.CUBresCUSH2.plot_par_space" title="cubmods.cush2.CUBresCUSH2.plot_par_space"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_par_space</span></code></a>([figsize, ax, ci, saveas])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic standard error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">11)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the standard error</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability distribution and,
if provided, probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2.plot_par_space">
<span class="sig-name descname"><span class="pre">plot_par_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2.plot_par_space" title="Link to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic standard error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUSH2 model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>delta1</strong> (<em>float</em>) – 1st shelter choice parameter <span class="math notranslate nohighlight">\(\delta_1\)</span></p></li>
<li><p><strong>delta2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function for a CUSH2 model without covariates.</p>
<p>Compute the log-likelihood function for a CUSH2 model 
without covariate for the given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>c1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>c2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likehood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUSH2 models without covariates.</p>
<p>Estimate and validate a CUSH2 model for ordinal responses, without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>c1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>c2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>None</em>) – default to None; ensure compatibility with <code class="docutils literal notranslate"><span class="pre">gem.from_formula()</span></code></p></li>
<li><p><strong>tol</strong> (<em>None</em>) – default to None; ensure compatibility with <code class="docutils literal notranslate"><span class="pre">gem.from_formula()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUSH2</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.pmf" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUSH2 model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>c1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>c2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>d1</strong> (<em>float</em>) – 1st shelter choice parameter <span class="math notranslate nohighlight">\(\delta_1\)</span></p></li>
<li><p><strong>d2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.varcov" title="Link to this definition">#</a></dt>
<dd><p>Compute the variance-covariance matrix of parameter 
estimates of a CUSH2 model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses</p></li>
<li><p><strong>d1</strong> (<em>float</em>) – 1st shelter choice parameter <span class="math notranslate nohighlight">\(\delta_1\)</span></p></li>
<li><p><strong>d2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
<li><p><strong>fc1</strong> (<em>float</em>) – relative frequency of 1st shelter choice</p></li>
<li><p><strong>fc2</strong> (<em>float</em>) – relative frequency of 2nd shelter choice</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cush2_x0">
<span id="cubmods-cush2-x0-module"></span><h2>cubmods.cush2_x0 module<a class="headerlink" href="#module-cubmods.cush2_x0" title="Link to this heading">#</a></h2>
<p id="cush2x0-module">CUB models in Python.
Module for CUSH2 (Combination of Uniform
and 2 Shelter Choices) with covariates
for the 1st shelter choice.</p>
<section id="id53">
<h3>Description:<a class="headerlink" href="#id53" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH2 model family.</p>
</div></blockquote>
</section>
<section id="id54">
<h3>Manual, Examples and References:<a class="headerlink" href="#id54" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cush2-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id55">
<h3>List of TODOs:<a class="headerlink" href="#id55" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id56">
<h3>Credits<a class="headerlink" href="#id56" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id57">
<h3>Classes and Functions<a class="headerlink" href="#id57" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush2_x0.CUBresCUSH2X0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH2X0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.CUBresCUSH2X0" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot" title="cubmods.cush2_x0.CUBresCUSH2X0.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal" title="cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_x0.CUBresCUSH2X0.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUSH2 model,
with covariates for the 1st shelter choice only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>delta2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.effe" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUSH2 models.</p>
<p>Compute the opposite of the scalar function that is maximized when running
the E-M algorithm for CUSH2 models with covariates for the 1st shelter choice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of parameters</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function for a CUSH2 model with covariates
for the 1st shelter choice only.</p>
<p>Compute the log-likelihood function for a CUSH2 model 
with covariates for the 1st shelter choice only,
for the given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>delta2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likehood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUSH2 models with covariates for the 1st shelter choice only.</p>
<p>Estimate and validate a CUSH2 model for given ordinal responses, with covariates for the 1st shelter choice only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUSH2X0</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUSH2 model with covariates
for the 1st shelter choice.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>delta2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the average probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUSH2 model with covariates
for the first shelter choice only.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>delta2</strong> (<em>float</em>) – 2nd shelter choice parameter <span class="math notranslate nohighlight">\(\delta_2\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cush2_xx">
<span id="cubmods-cush2-xx-module"></span><h2>cubmods.cush2_xx module<a class="headerlink" href="#module-cubmods.cush2_xx" title="Link to this heading">#</a></h2>
<p id="cush2xx-module">CUB models in Python.
Module for CUSH2 (Combination of Uniform
and 2 Shelter Choices) with covariates.</p>
<section id="id58">
<h3>Description:<a class="headerlink" href="#id58" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH2 model family with covariates for
both shelter choices.</p>
</div></blockquote>
</section>
<section id="id59">
<h3>Manual, Examples and References:<a class="headerlink" href="#id59" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cush2-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id60">
<h3>List of TODOs:<a class="headerlink" href="#id60" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id61">
<h3>Credits<a class="headerlink" href="#id61" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id62">
<h3>Classes and Functions<a class="headerlink" href="#id62" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush2_xx.CUBresCUSH2XX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH2XX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.CUBresCUSH2XX" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot" title="cubmods.cush2_xx.CUBresCUSH2XX.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal" title="cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_xx.CUBresCUSH2XX.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUSH2 model,
with covariates for both shelter choices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega2</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_2\)</span> of parameters for the 2nd shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X2.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>X2</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 2nd shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.effe" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUSH2 models.</p>
<p>Compute the opposite of the scalar function that is maximized when running
the E-M algorithm for CUSH2 models with covariates for both shelter choices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of parameters</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>X2</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 2nd shelter effect</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function for a CUSH2 model with covariates
for both shelter choices.</p>
<p>Compute the log-likelihood function for a CUSH2 model 
with covariates for both shelter choices,
for the given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega2</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_2\)</span> of parameters for the 2nd shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X2.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>X2</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 2nd shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likehood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUSH2 models with covariates for both shelter choices.</p>
<p>Estimate and validate a CUSH2 model for given ordinal responses, with covariates for both shelter choices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>X2</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 2nd shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUSH2XX</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUSH2 model with covariates
for both shelter choices.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega2</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_2\)</span> of parameters for the 2nd shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X2.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>X2</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 2nd shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the average probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUSH2 model with covariates
for both shelter choices.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh1</strong> (<em>int</em>) – Category corresponding to the 1st shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>sh2</strong> (<em>int</em>) – Category corresponding to the 2nd shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega1</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_1\)</span> of parameters for the 1st shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X1.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>omega2</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega_2\)</span> of parameters for the 2nd shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X2.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X1</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 1st shelter effect</p></li>
<li><p><strong>X2</strong> (<em>DataFrame</em>) – dataframe of covariates for explaining the 2nd shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.cush_x">
<span id="cubmods-cush-x-module"></span><h2>cubmods.cush_x module<a class="headerlink" href="#module-cubmods.cush_x" title="Link to this heading">#</a></h2>
<p id="cushx-module">CUB models in Python.
Module for CUSH (Combination of Uniform
and Shelter effect) with covariates.</p>
<section id="id63">
<h3>Description:<a class="headerlink" href="#id63" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH model family.</p>
</div></blockquote>
</section>
<section id="id64">
<h3>Manual, Examples and References:<a class="headerlink" href="#id64" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#cush-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id65">
<h3>List of TODOs:<a class="headerlink" href="#id65" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id66">
<h3>Credits<a class="headerlink" href="#id66" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id67">
<h3>Classes and Functions<a class="headerlink" href="#id67" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush_x.CUBresCUSHX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSHX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.CUBresCUSHX" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush_x.CUBresCUSHX.plot" title="cubmods.cush_x.CUBresCUSHX.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cush_x.CUBresCUSHX.plot_ordinal" title="cubmods.cush_x.CUBresCUSHX.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots avreage relative frequencies of observed sample, estimated  average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush_x.CUBresCUSHX.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.CUBresCUSHX.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush_x.CUBresCUSHX.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.CUBresCUSHX.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots avreage relative frequencies of observed sample, estimated 
average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUSH model with covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.effe" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUSH models with covariates</p>
<p>Compute the opposite of the loglikelihood function for CUSH models
with covariates to explain the shelter effect.
It is called as an argument for “optim” within <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function
as the function to minimize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of the initial parameters estimates</p></li>
<li><p><strong>esterno</strong> (<em>ndarray</em>) – matrix binding together the vector of ordinal data and the matrix <code class="docutils literal notranslate"><span class="pre">XX</span></code> of explanatory
variables whose first column is a column of ones needed to consider an intercept term</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function for CUSH models with covariates.</p>
<p>Compute the log-likelihood function for CUSH models with covariates 
to explain the shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUSH models with covariates.</p>
<p>Estimate and validate a CUSH model for ordinal responses, with covariates
to explain the shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>None</em>) – default to None; ensure compatibility with <code class="docutils literal notranslate"><span class="pre">gem.from_formula()</span></code></p></li>
<li><p><strong>tol</strong> (<em>None</em>) – default to None; ensure compatibility with <code class="docutils literal notranslate"><span class="pre">gem.from_formula()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUSHX</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified CUSH model with covariates.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUSH model with covariates</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUSH model with covariates.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\;i = 1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>sh</strong> (<em>int</em>) – Category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>omega</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \omega\)</span> of parameters for the shelter effect, whose length equals 
<code class="docutils literal notranslate"><span class="pre">X.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>X</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the shelter effect</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability array <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> for observed responses</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.gem">
<span id="cubmods-gem-module"></span><h2>cubmods.gem module<a class="headerlink" href="#module-cubmods.gem" title="Link to this heading">#</a></h2>
<p id="gem-module">CUB models in Python.
Module for GEM (Generalized Mixtures).</p>
<section id="id68">
<h3>Description:<a class="headerlink" href="#id68" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for GEM maximum likelihood estimation
and sample drawing.</p>
</div></blockquote>
</section>
<section id="id69">
<h3>Manual, Examples and References:<a class="headerlink" href="#id69" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#gem-manual">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id70">
<h3>List of TODOs:<a class="headerlink" href="#id70" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: implement best shelter search</p></li>
</ul>
</div></blockquote>
</section>
<section id="id71">
<h3>Credits<a class="headerlink" href="#id71" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id72">
<h3>Classes and Functions<a class="headerlink" href="#id72" title="Link to this heading">#</a></h3>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="cubmods.gem.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.gem.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cub'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.gem.draw" title="Link to this definition">#</a></dt>
<dd><p>Main function to draw a sample from GEneralized Mixture models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>str</em>) – a formula used to draw the sample, see
Manual for details</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – the DataFrame with covariates (if any)</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>model</strong> (<em>str</em>) – the model family; default to <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>; options <code class="docutils literal notranslate"><span class="pre">&quot;cube&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;cush&quot;</span></code></p></li>
<li><p><strong>sh</strong> (<em>int</em>) – category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses; it is only effective if the model
is without covariates</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>options</strong> (<em>dict</em>) – a dictionary of extra options <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> and <code class="docutils literal notranslate"><span class="pre">tol</span></code>; see the reference
guide for details</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.gem.estimate">
<span class="sig-prename descclassname"><span class="pre">cubmods.gem.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cub'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.gem.estimate" title="Link to this definition">#</a></dt>
<dd><p>Main function to estimate and validate GEneralized Mixture models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>str</em>) – a formula used to estimate the model’s parameters, see
Manual for details</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – the DataFrame with observed ordinal sample and covariates (if any)</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>model</strong> (<em>str</em>) – the model family; default to <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>; options <code class="docutils literal notranslate"><span class="pre">&quot;cube&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;cush&quot;</span></code></p></li>
<li><p><strong>sh</strong> (<em>int</em>) – category corresponding to the shelter choice <span class="math notranslate nohighlight">\([1,m]\)</span></p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>options</strong> (<em>dict</em>) – a dictionary of extra options <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> and <code class="docutils literal notranslate"><span class="pre">tol</span></code>; see the reference
guide for details</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of the Base Class <code class="docutils literal notranslate"><span class="pre">CUBres</span></code> extended by the family module;
see each module for details</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.general">
<span id="cubmods-general-module"></span><h2>cubmods.general module<a class="headerlink" href="#module-cubmods.general" title="Link to this heading">#</a></h2>
<p>CUB models in Python.
Module for General functions.</p>
<section id="id73">
<h3>Description:<a class="headerlink" href="#id73" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for general functions.</p>
</div></blockquote>
</section>
<section id="id74">
<h3>List of TODOs:<a class="headerlink" href="#id74" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id75">
<h3>Credits<a class="headerlink" href="#id75" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id76">
<h3>Classes and Functions<a class="headerlink" href="#id76" title="Link to this heading">#</a></h3>
</section>
<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.InvalidCategoriesError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">InvalidCategoriesError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.InvalidCategoriesError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if m is not suitable for model.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.InvalidSampleSizeError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">InvalidSampleSizeError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.InvalidSampleSizeError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if the sample size is not strictly greater than zero.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.NoShelterError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">NoShelterError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.NoShelterError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if a shelter choice is needed but it hasn’t been provided.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.NotImplementedModelError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">NotImplementedModelError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.NotImplementedModelError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if the requested model is known but not
yet implemented.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.ParameterOutOfBoundsError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">ParameterOutOfBoundsError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.ParameterOutOfBoundsError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if the provided parameter value is out of bounds.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.ShelterGreaterThanM">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">ShelterGreaterThanM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.ShelterGreaterThanM" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if the provided shelter choice is greater than <span class="math notranslate nohighlight">\(m\)</span>.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.UnknownModelError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">UnknownModelError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.UnknownModelError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception: if the requested family is unknown.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.addones">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">addones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.addones" title="Link to this definition">#</a></dt>
<dd><p>Expand with a unitary vector in the first column of the given matrix
to consider also an intercept term for CUB models with covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>A</strong> – a matrix to be expanded</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expanded matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>same of <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.aic">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">aic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.aic" title="Link to this definition">#</a></dt>
<dd><p>Akaike Information Criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float</em>) – log-likelihood</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the AIC value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.bic">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">bic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.bic" title="Link to this definition">#</a></dt>
<dd><p>Bayesian Information Criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float</em>) – log-likelihood</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of parameters</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the BIC value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.bitgamma">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">bitgamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.bitgamma" title="Link to this definition">#</a></dt>
<dd><p>Shifted Binomial distribution with covariates.</p>
<p>Return the shifted Binomial probabilities of ordinal responses where the feeling component 
is explained by covariates via a logistic link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component</p></li>
<li><p><strong>gamma</strong> (<em>array</em><em> of </em><em>float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of the same length as <code class="docutils literal notranslate"><span class="pre">sample</span></code>, where each entry is the shifted Binomial probability for
the corresponding observation and feeling value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.bitxi">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">bitxi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.bitxi" title="Link to this definition">#</a></dt>
<dd><p>Shifted Binomial probabilities of ordinal responses</p>
<p>Compute the shifted Binomial probabilities of ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em>) – array of ordinal responses</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A vector of the same length as <code class="docutils literal notranslate"><span class="pre">sample</span></code>, where each entry is the shifted Binomial probability 
of the corresponding observation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.choices">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">choices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.choices" title="Link to this definition">#</a></dt>
<dd><p>Array of ordinal categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of int from 1 to m</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.colsof">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">colsof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.colsof" title="Link to this definition">#</a></dt>
<dd><p>Number of columns of the given
matrix or dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>A</strong> (<em>ndarray</em><em>, </em><em>dataframe</em>) – the matrix or dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.conf_border">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">conf_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.conf_border" title="Link to this definition">#</a></dt>
<dd><p>Plot the bivariate projection of a trivariate confidence ellipse
on a plane.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">plot_ellipsoid()</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Solution by <a class="reference external" href="https://gist.github.com/randolf-scholz">https://gist.github.com/randolf-scholz</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Sigma</strong> (<em>ndarray</em>) – bivariate variance-covariance matrix</p></li>
<li><p><strong>mx</strong> (<em>float</em>) – center of the ellipse on the <span class="math notranslate nohighlight">\(x\)</span> axies</p></li>
<li><p><strong>my</strong> (<em>float</em>) – center of the ellipse on the <span class="math notranslate nohighlight">\(y\)</span> axies</p></li>
<li><p><strong>ax</strong> – matpplotlib axis</p></li>
<li><p><strong>conf</strong> (<em>float</em>) – confidence level of the trivariate ellipsoid.</p></li>
<li><p><strong>plane</strong> (<em>str</em>) – plane for the projection; could be <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> or <code class="docutils literal notranslate"><span class="pre">z</span></code></p></li>
<li><p><strong>xyz0</strong> (<em>tuple</em>) – tuple of the bivariate ellipse position</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.conf_ell">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">conf_ell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.conf_ell" title="Link to this definition">#</a></dt>
<dd><p>Plot bivariate confidence ellipse of estimated
parameters at level <code class="docutils literal notranslate"><span class="pre">ci</span></code><span class="math notranslate nohighlight">\(=(1 - \alpha/2)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vcov</strong> (<em>ndarray</em>) – Variance-covariance matrix <span class="math notranslate nohighlight">\(2 \times 2\)</span></p></li>
<li><p><strong>mux</strong> (<em>float</em>) – estimate of first parameter</p></li>
<li><p><strong>muy</strong> (<em>float</em>) – estimate of second parameter</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – confidence level <span class="math notranslate nohighlight">\(=(1 - \alpha/2)\)</span></p></li>
<li><p><strong>ax</strong> – matplotlib axis</p></li>
<li><p><strong>color</strong> (<em>str</em>) – color of confidence ellipse</p></li>
<li><p><strong>label</strong> (<em>bool</em>) – whether to add a label of confidence level</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – transparency of confidence ellipse</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.dissimilarity">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">dissimilarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_est</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.dissimilarity" title="Link to this definition">#</a></dt>
<dd><p>Normalized dissimilarity measure.</p>
<p>Compute the normalized dissimilarity measure between observed
relative frequencies and estimated (theoretical) probabilities of a discrete distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_obs</strong> (<em>array</em>) – Vector of observed relative frequencies</p></li>
<li><p><strong>p_est</strong> (<em>array</em>) – Vector of estimated (theoretical) probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numeric value of the dissimilarity index, assessing the distance to a perfect fit.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.dummies2">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">dummies2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.dummies2" title="Link to this definition">#</a></dt>
<dd><p>Create dummy variables from polychotomous variables.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">cubmods.gem.from_formula()</span></code>.
A dummy variable is created for all polychotomous variables named
<code class="docutils literal notranslate"><span class="pre">C(&lt;varname&gt;)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – a DataFrame with all the covariates and the ordinal response</p></li>
<li><p><strong>DD</strong> (<em>list</em>) – the list of all covariates for each component</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of the DataFrame with the dummy variables and the column names</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.equal3d">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">equal3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.equal3d" title="Link to this definition">#</a></dt>
<dd><p>Equalize 3d axes.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.plot_ellipsoid()</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.expit">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">expit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.expit" title="Link to this definition">#</a></dt>
<dd><p>Expit function.</p>
<p>It is the inverse of logit. Aka
sigmoid or standard logistic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – the argument</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expit of x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.formula_parser">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">formula_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cub'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.formula_parser" title="Link to this definition">#</a></dt>
<dd><p>Parse a CUB class formula.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">cubmods.gem</span></code> functions.</p>
<p>TODO: add specific Exceptions for formula</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>str</em>) – the formula to be parsed</p></li>
<li><p><strong>model</strong> (<em>str</em>) – the model family</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of the ordinal response column name and a list of all
covariates’ column names for each component</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.freq">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataframe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.freq" title="Link to this definition">#</a></dt>
<dd><p>Absolute frequecies of an
observed sample of ordinal
responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>dataframe</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> return
a DataFrame instead of an array,
defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the absolute frequencies of the observed sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array or dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.get_cov_ellipsoid">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">get_cov_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.get_cov_ellipsoid" title="Link to this definition">#</a></dt>
<dd><p>Return the 3d points representing the covariance matrix
<code class="docutils literal notranslate"><span class="pre">cov</span></code> centred at <code class="docutils literal notranslate"><span class="pre">mu</span></code>, at confidence level <code class="docutils literal notranslate"><span class="pre">ci</span></code><span class="math notranslate nohighlight">\(=(1 - \alpha/2)\)</span>.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.plot_ellipsoid()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov</strong> (<em>ndarray</em>) – Variance-covariance matrix <span class="math notranslate nohighlight">\(3 \times 3\)</span></p></li>
<li><p><strong>mu</strong> (<em>array</em>) – ellispoid center <span class="math notranslate nohighlight">\((x_0, y_0, z_0)\)</span></p></li>
<li><p><strong>ci</strong> (<em>float</em>) – confidence level <span class="math notranslate nohighlight">\(=(1 - \alpha/2)\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of 3d points <code class="docutils literal notranslate"><span class="pre">(X,</span> <span class="pre">Y,</span> <span class="pre">Z)</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.get_minor">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">get_minor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.get_minor" title="Link to this definition">#</a></dt>
<dd><p>Get a minor of a matrix.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.plot_ellipsoid()</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Solution by PaulDong</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em>) – a generic matrix</p></li>
<li><p><strong>i</strong> (<em>int</em>) – row of the minor</p></li>
<li><p><strong>j</strong> (<em>int</em>) – column of the minor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the minor of <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.hadprod">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">hadprod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Amat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xvett</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.hadprod" title="Link to this definition">#</a></dt>
<dd><p>Hadamard product of a matrix with a vector</p>
<p>Return the Hadamard product between the given matrix and vector: this operation corresponds 
to multiply every row of the matrix by the corresponding element of the vector, and it is equivalent to the 
standard matrix multiplication to the right with the diagonal matrix whose diagonal is the given vector. 
It is possible only if the length of the vector equals the number of rows of the matrix.
It is an auxiliary function needed for computing the variance-covariance matrix of the estimated model 
with covariates.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <code class="docutils literal notranslate"><span class="pre">xvett</span></code> is a row vector, reshapes it to column vector</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Amat</strong> (<em>ndarray</em>) – A generic matrix</p></li>
<li><p><strong>xvett</strong> (<em>array</em>) – A generic vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Hadamard product <span class="math notranslate nohighlight">\(\pmb A \odot \pmb x\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.kkk">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">kkk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.kkk" title="Link to this definition">#</a></dt>
<dd><p>Sequence of combinatorial coefficients</p>
<p>Compute the sequence of binomial coefficients <span class="math notranslate nohighlight">\(\binom{m-1}{r-1}\)</span>, for <span class="math notranslate nohighlight">\(r= 1, \ldots m\)</span>, 
and then returns a vector of the same length as ordinal, whose i-th component is the corresponding binomial 
coefficient <span class="math notranslate nohighlight">\(\binom{m-1}{r_i-1}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(\binom{m-1}{r_i-1}\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.load_object">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">load_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.load_object" title="Link to this definition">#</a></dt>
<dd><p>Load a saved object from file.</p>
<p>It can used be used to load a <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> or a
<code class="docutils literal notranslate"><span class="pre">CUBres</span></code> object, previously saved on a file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>see the Classes for details about these objects</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>str</em>) – filename</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the loaded object, instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> or <code class="docutils literal notranslate"><span class="pre">CUBres</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.logis">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">logis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.logis" title="Link to this definition">#</a></dt>
<dd><p>The logistic transform.</p>
<p>Create a matrix <code class="docutils literal notranslate"><span class="pre">YY</span></code> binding array <code class="docutils literal notranslate"><span class="pre">Y</span></code> with a vector of ones, placed as the first column of <code class="docutils literal notranslate"><span class="pre">YY</span></code>. 
It applies the logistic transform componentwise to the standard matrix multiplication between <code class="docutils literal notranslate"><span class="pre">YY</span></code> and <code class="docutils literal notranslate"><span class="pre">param</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> (<em>ndarray</em><em>, </em><em>dataframe</em>) – A generic matrix or a dataframe</p></li>
<li><p><strong>param</strong> (<em>array</em>) – Vector of coefficients, whose length is <code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> (to consider also an intercept term)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a vector whose length is <code class="docutils literal notranslate"><span class="pre">Y.index.size</span></code> and whose i-th component is the logistic function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.logit">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.logit" title="Link to this definition">#</a></dt>
<dd><p>Logit function.</p>
<p>It is the inverse of the
standard logistic function, aka
log-odds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – the argument</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logit of x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.lsat">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">lsat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.lsat" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood of saturated model.</p>
<p>Saturated level ,that is the theoretically maximum information
that can be obtained by a model using as many parameters as possible. 
Then, the saturated log-likelihood is computed by assuming that the model 
is specified by as many parameters as available observations. 
This is the extreme benchmark for comparing
previous log-likelihood quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array</em>) – absolute frequencies of observed ordinal responses</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log-likelihood of saturated model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.luni">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">luni</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.luni" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood of null model.</p>
<p>Null level, that is when no 
structure is searched for. 
Specifically, this is equivalent to 
assume a discrete Uniform over 
the support so that any category 
has the same probability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood of null model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.plot_ellipsoid">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">plot_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.plot_ellipsoid" title="Link to this definition">#</a></dt>
<dd><p>Plot a trivariate confidence ellipsoid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Variance-covariance matrix</p></li>
<li><p><strong>E</strong> (<em>array</em>) – Vector of estimated parameters</p></li>
<li><p><strong>ax</strong> – matplotlib axis</p></li>
<li><p><strong>zlabel</strong> (<em>str</em>) – label for <span class="math notranslate nohighlight">\(z\)</span> axis</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – confidence level <span class="math notranslate nohighlight">\((1 - \alpha/2)\)</span></p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">False</span></code> plots in the full parameter space</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.probbit">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">probbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.probbit" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of 
shifted binomial random variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability 
distribution of a shifted Binomial 
model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.unique">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.unique" title="Link to this definition">#</a></dt>
<dd><p>Unique elements in a 3-dimensional list.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.dummies2()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>l</strong> (<em>list</em>) – the list to analyze</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the list of unique elements</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.ihg">
<span id="cubmods-ihg-module"></span><h2>cubmods.ihg module<a class="headerlink" href="#module-cubmods.ihg" title="Link to this heading">#</a></h2>
<p id="ihg0-module">CUB models in Python.
Module for IHG (Inverse HyperGeometric).</p>
<section id="id77">
<h3>Description:<a class="headerlink" href="#id77" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for IHG model family without covariates.</p>
</div></blockquote>
</section>
<section id="id78">
<h3>Manual, Examples and References:<a class="headerlink" href="#id78" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#ihg-without-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id79">
<h3>List of TODOs:<a class="headerlink" href="#id79" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id80">
<h3>Credits<a class="headerlink" href="#id80" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id81">
<h3>Classes and Functions<a class="headerlink" href="#id81" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">CUBresIHG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base for details.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.ihg.CUBresIHG.plot" title="cubmods.ihg.CUBresIHG.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.ihg.CUBresIHG.plot_estim" title="cubmods.ihg.CUBresIHG.plot_estim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_estim</span></code></a>([ci, ax, magnified])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic standard error.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.ihg.CUBresIHG.plot_ordinal" title="cubmods.ihg.CUBresIHG.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability distribution and, if provided, probability distribution of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the standard error</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG.plot_estim">
<span class="sig-name descname"><span class="pre">plot_estim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG.plot_estim" title="Link to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic standard error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability distribution and,
if provided, probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified IHG model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – parameter <span class="math notranslate nohighlight">\(\theta\)</span> (probability of 1st shelter category)</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.effe" title="Link to this definition">#</a></dt>
<dd><p>Compute the negative log-likelihood function of a IHG model without 
covariates for a given absolute frequency distribution.
Auxiliary function of <code class="docutils literal notranslate"><span class="pre">mle()</span></code> for optimization algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – parameter <span class="math notranslate nohighlight">\(\theta\)</span> (probability of 1st shelter category)</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary estimators for IHG models without covariates.</p>
<p>Computes preliminary parameter estimates of a IHG model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of the absolute frequencies of given ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the value of <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.loglik" title="Link to this definition">#</a></dt>
<dd><p>Compute the log-likelihood function of a IHG model without 
covariates for a given absolute frequency distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – parameter :math:`     heta` (probability of 1st shelter category)</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for CUB models without covariates.</p>
<p>Function to estimate and validate a CUB model without covariates for given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresIHG</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.pmf" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a specified IHG model without covariates.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – parameter <span class="math notranslate nohighlight">\(\theta\)</span> (probability of 1st shelter category)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution of a CUB model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.var" title="Link to this definition">#</a></dt>
<dd><p>Variance of a specified IHG model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – parameter <span class="math notranslate nohighlight">\(\theta\)</span> (probability of 1st shelter category)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.ihg_v">
<span id="cubmods-ihg-v-module"></span><h2>cubmods.ihg_v module<a class="headerlink" href="#module-cubmods.ihg_v" title="Link to this heading">#</a></h2>
<p id="ihgv-module">CUB models in Python.
Module for IHG (Inverse HyperGeometric) with covariates.</p>
<section id="id82">
<h3>Description:<a class="headerlink" href="#id82" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for IHG model family with covariates.</p>
</div></blockquote>
</section>
<section id="id83">
<h3>Manual, Examples and References:<a class="headerlink" href="#id83" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#ihg-with-covariates">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id84">
<h3>List of TODOs:<a class="headerlink" href="#id84" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id85">
<h3>Credits<a class="headerlink" href="#id85" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id86">
<h3>Classes and Functions<a class="headerlink" href="#id86" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.ihg_v.CUBresIHGV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">CUBresIHGV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.CUBresIHGV" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.ihg_v.CUBresIHGV.plot" title="cubmods.ihg_v.CUBresIHGV.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.ihg_v.CUBresIHGV.plot_ordinal" title="cubmods.ihg_v.CUBresIHGV.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots avreage relative frequencies of observed sample, estimated  average probability distribution and, if provided, average probability distribution of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg_v.CUBresIHGV.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.CUBresIHGV.plot" title="Link to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg_v.CUBresIHGV.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.CUBresIHGV.plot_ordinal" title="Link to this definition">#</a></dt>
<dd><p>Plots avreage relative frequencies of observed sample, estimated 
average probability distribution and,
if provided, average probability distribution of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.draw" title="Link to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified IHG model with covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>nu</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \nu\)</span> of parameters for <span class="math notranslate nohighlight">\(\theta\)</span>, whose length equals 
<code class="docutils literal notranslate"><span class="pre">V.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> (see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a>) containing ordinal responses drawn from the specified model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.effe" title="Link to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of IHG models with covariates</p>
<p>Compute the opposite of the loglikelihood function for IHG models
with covariates.
It is called as an argument for “optim” within <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function
as the function to minimize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>float</em>) – initial parameter estimate</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.init_theta" title="Link to this definition">#</a></dt>
<dd><p>Preliminary estimators for IHG models without covariates.</p>
<p>Computes preliminary parameter estimates of a IHG model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array</em><em> of </em><em>int</em>) – array of the absolute frequencies of given ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of <span class="math notranslate nohighlight">\(\pmb\nu^{(0)}\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.loglik" title="Link to this definition">#</a></dt>
<dd><p>Log-likelihood function for IHG models with covariates.</p>
<p>Compute the log-likelihood function for CUSH models with covariates 
to explain the shelter effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>nu</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \nu\)</span> of parameters for <span class="math notranslate nohighlight">\(\theta\)</span>, whose length equals 
<code class="docutils literal notranslate"><span class="pre">V.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.mle" title="Link to this definition">#</a></dt>
<dd><p>Main function for IHG models with covariates.</p>
<p>Estimate and validate a IHG model for ordinal responses, with covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>df</strong> (<em>DataFrame</em>) – original DataFrame</p></li>
<li><p><strong>formula</strong> (<em>str</em>) – the formula used</p></li>
<li><p><strong>ass_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresIHGV</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.pmf" title="Link to this definition">#</a></dt>
<dd><p>Average probability distribution of a specified IHG model with covariates.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R_i=r|\pmb\theta; \pmb T_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>nu</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \nu\)</span> of parameters for <span class="math notranslate nohighlight">\(\theta\)</span>, whose length equals 
<code class="docutils literal notranslate"><span class="pre">V.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.pmfi" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified IHG model with covariates</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r|\pmb\theta; \pmb T_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>nu</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \nu\)</span> of parameters for <span class="math notranslate nohighlight">\(\theta\)</span>, whose length equals 
<code class="docutils literal notranslate"><span class="pre">V.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.prob" title="Link to this definition">#</a></dt>
<dd><p>Probability distribution of a IHG model with covariates
given an observed sample.</p>
<p>Compute the probability distribution of a IHG model with covariates, 
given an observed sample.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R_i=r_i|\pmb\theta;\pmb T_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em><em> of </em><em>int</em>) – array of ordinal responses</p></li>
<li><p><strong>nu</strong> (<em>array</em>) – array <span class="math notranslate nohighlight">\(\pmb \nu\)</span> of parameters for <span class="math notranslate nohighlight">\(\theta\)</span>, whose length equals 
<code class="docutils literal notranslate"><span class="pre">V.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>V</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the parameter <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.multicub">
<span id="cubmods-multicub-module"></span><h2>cubmods.multicub module<a class="headerlink" href="#module-cubmods.multicub" title="Link to this heading">#</a></h2>
<p id="multicub-module">CUB models in Python.
Module for MULTICUB and MULTICUBE.</p>
<section id="id87">
<h3>Description:<a class="headerlink" href="#id87" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for MULTICUB and MULTICUBE tool.</p>
</div></blockquote>
</section>
<section id="id88">
<h3>Manual, Examples and References:<a class="headerlink" href="#id88" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="manual.html#multicub-manual">Models manual</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id89">
<h3>List of TODOs:<a class="headerlink" href="#id89" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
</section>
<section id="id90">
<h3>Credits<a class="headerlink" href="#id90" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id91">
<h3>Classes and Functions<a class="headerlink" href="#id91" title="Link to this heading">#</a></h3>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="cubmods.multicub.multi">
<span class="sig-prename descclassname"><span class="pre">cubmods.multicub.</span></span><span class="sig-name descname"><span class="pre">multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cub'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.multicub.multi" title="Link to this definition">#</a></dt>
<dd><p>Joint plot of estimated CUB models in the parameter space</p>
<p>Return a plot of estimated CUB models represented as points in the parameter space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ords</strong> (<em>list</em>) – list of arrays of observed ordinal responses</p></li>
<li><p><strong>model</strong> (<em>str</em>) – model; defaults to <code class="docutils literal notranslate"><span class="pre">cub</span></code>; options <code class="docutils literal notranslate"><span class="pre">cube</span></code></p></li>
<li><p><strong>title</strong> (<em>str</em>) – title of the plot</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – labels of the points</p></li>
<li><p><strong>shs</strong> (<em>int</em><em> or </em><em>list</em>) – shelter effect(s); can be an <em>int</em> if the same shelter
effect is valid for all samples or a <em>list</em> to specify different
shelter choices</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) plot the results;</p></li>
<li><p><strong>print_res</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> print the results; defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>pos</strong> (<em>list</em>) – position of the <span class="math notranslate nohighlight">\(\delta\)</span> or <span class="math notranslate nohighlight">\(\phi\)</span> estimated values</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em>) – x-axis limits</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em>) – y-axis limits</p></li>
<li><p><strong>equal</strong> (<em>bool</em>) – if the plot must have equal aspect; defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – confidence ellipse transparency</p></li>
<li><p><strong>confell</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) plot confidence ellipse (for CUB model only)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.multicub.pos_kwargs">
<span class="sig-prename descclassname"><span class="pre">cubmods.multicub.</span></span><span class="sig-name descname"><span class="pre">pos_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.multicub.pos_kwargs" title="Link to this definition">#</a></dt>
<dd><p>Position of the <span class="math notranslate nohighlight">\(\delta\)</span> or <span class="math notranslate nohighlight">\(\phi\)</span> estimated values</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    1
  8   2
7   @   3
  6   4
    5
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos</strong> (<em>int</em>) – position (1..8)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary for <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cubmods.smry">
<span id="cubmods-smry-module"></span><h2>cubmods.smry module<a class="headerlink" href="#module-cubmods.smry" title="Link to this heading">#</a></h2>
<p>CUB models in Python.
Module for summary tools.</p>
<section id="id92">
<h3>Description:<a class="headerlink" href="#id92" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for summary tools.</p>
</div></blockquote>
</section>
<section id="id93">
<h3>List of TODOs:<a class="headerlink" href="#id93" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: risultati inferenziali come DataFrame nel Manuale e negli esempi</p></li>
<li><p>TODO: bounds opzionali in CUBE mle (anche CUBSH?)</p></li>
<li><p>TODO: 2 decimali nei 3d plot?</p></li>
<li><p>TODO: dissim in multicub plot (aggiungere opzione)</p></li>
<li><p>TODO: grandezza punti phi in multicube</p></li>
</ul>
</div></blockquote>
</section>
<section id="id94">
<h3>Credits<a class="headerlink" href="#id94" title="Link to this heading">#</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credits<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id95">
<h3>Classes and Functions<a class="headerlink" href="#id95" title="Link to this heading">#</a></h3>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.smry.CUBres">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.smry.</span></span><span class="sig-name descname"><span class="pre">CUBres</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ass_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Default Class for MLE results; each model module extends this Class to an ad hoc 
Class with specific functions. An instance of the extended Class is returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code>
functions of model modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model family</p></li>
<li><p><strong>df</strong> – the original DataFrame with observed sample and covariates (if any)</p></li>
<li><p><strong>formula</strong> – the formula used to fit the data</p></li>
<li><p><strong>m</strong> – number of ordinal categories</p></li>
<li><p><strong>n</strong> – number of observed ordinal responses</p></li>
<li><p><strong>sample</strong> – the observed sample of ordinal resposes</p></li>
<li><p><strong>f</strong> – absolute frequecies of the sample</p></li>
<li><p><strong>theoric</strong> – estimated probabilty distribution</p></li>
<li><p><strong>diss</strong> – dissimilarity index</p></li>
<li><p><strong>est_names</strong> – name of estimated parameters</p></li>
<li><p><strong>estimates</strong> – values of estimated parameters</p></li>
<li><p><strong>e_types</strong> – parameters’ component</p></li>
<li><p><strong>varmat</strong> – variance-covariance matrix of estimated parameters</p></li>
<li><p><strong>srtderrs</strong> – standard errors of estimated parameters</p></li>
<li><p><strong>pval</strong> – p-values of estimated parameters</p></li>
<li><p><strong>wald</strong> – Wald test statistics of estimated parameters</p></li>
<li><p><strong>loglike</strong> – log-likelihood value</p></li>
<li><p><strong>muloglik</strong> – average log-likelihood for each observation</p></li>
<li><p><strong>loglikuni</strong> – log-likelihood of null model</p></li>
<li><p><strong>AIC</strong> – Akaike Information Criterion</p></li>
<li><p><strong>BIC</strong> – Bayesian Information Criterino</p></li>
<li><p><strong>seconds</strong> – execution time of the algorithm</p></li>
<li><p><strong>time_exe</strong> – when the algorithm has been executed</p></li>
<li><p><strong>logliksat</strong> – log-likelihood of saturated model (for models without covariates only)</p></li>
<li><p><strong>logliksatcov</strong> – <strong>deprecated</strong></p></li>
<li><p><strong>dev</strong> – deviance</p></li>
<li><p><strong>niter</strong> – number of iterations of the EM algorithm</p></li>
<li><p><strong>maxiter</strong> – maximum number of iterations of the EM algorithm</p></li>
<li><p><strong>tol</strong> – fixed error tolerance</p></li>
<li><p><strong>sh</strong> – shelter choice(s), if any</p></li>
<li><p><strong>rho</strong> – coefficient of correlation between <span class="math notranslate nohighlight">\(\pi\)</span> and <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>ass_pars</strong> – parameters of known model to be compared with the estimates</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.as_dataframe" title="cubmods.smry.CUBres.as_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code></a>()</p></td>
<td><p>DataFrame of estimated parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.as_txt" title="cubmods.smry.CUBres.as_txt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code></a>()</p></td>
<td><p>Print the summary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.save" title="cubmods.smry.CUBres.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(fname)</p></td>
<td><p>Save a CUBresult object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.summary" title="cubmods.smry.CUBres.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.as_dataframe">
<span class="sig-name descname"><span class="pre">as_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.as_dataframe" title="Link to this definition">#</a></dt>
<dd><p>DataFrame of estimated parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.as_txt">
<span class="sig-name descname"><span class="pre">as_txt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.as_txt" title="Link to this definition">#</a></dt>
<dd><p>Print the summary. Auxiliary function of <code class="docutils literal notranslate"><span class="pre">summary()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.save" title="Link to this definition">#</a></dt>
<dd><p>Save a CUBresult object to file
named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">.cub.fit</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.summary" title="Link to this definition">#</a></dt>
<dd><p>Call <code class="docutils literal notranslate"><span class="pre">as_txt()</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.smry.</span></span><span class="sig-name descname"><span class="pre">CUBsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An instance of this Class is returned by <code class="docutils literal notranslate"><span class="pre">.draw()</span></code> functions. 
See the corresponding model’s function for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rv</strong> – array of drawn ordinal responses</p></li>
<li><p><strong>m</strong> – number of ordinal categories</p></li>
<li><p><strong>n</strong> – number of drawn responses</p></li>
<li><p><strong>p</strong> – number of model’s parameters</p></li>
<li><p><strong>pars</strong> – parameters’ values array</p></li>
<li><p><strong>model</strong> – the model family</p></li>
<li><p><strong>df</strong> – original DataFrame (if provided) with a column of the drawn sample</p></li>
<li><p><strong>formula</strong> – the formula used to draw the sample</p></li>
<li><p><strong>diss</strong> – dissimilarity index between drawn and theoretical distribution</p></li>
<li><p><strong>theoric</strong> – theoretical distribution</p></li>
<li><p><strong>par_names</strong> – names of the parameters</p></li>
<li><p><strong>p_types</strong> – parameters’ component</p></li>
<li><p><strong>sh</strong> – shelter choice(s), if any</p></li>
<li><p><strong>seed</strong> – the <code class="docutils literal notranslate"><span class="pre">seed</span></code> used to ensure reproducibility</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.as_dataframe" title="cubmods.smry.CUBsample.as_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code></a>()</p></td>
<td><p>The parameters' values specified.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.plot" title="cubmods.smry.CUBsample.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([figsize, kind, ax, saveas])</p></td>
<td><p>Basic plot function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.save" title="cubmods.smry.CUBsample.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(fname)</p></td>
<td><p>Save a CUBsample object to file named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">cub.sample</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.summary" title="cubmods.smry.CUBsample.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Print the summary of the drawn sample.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.as_dataframe">
<span class="sig-name descname"><span class="pre">as_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.as_dataframe" title="Link to this definition">#</a></dt>
<dd><p>The parameters’ values specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a DataFrame with parameters’ names and values</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.plot" title="Link to this definition">#</a></dt>
<dd><p>Basic plot function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.save" title="Link to this definition">#</a></dt>
<dd><p>Save a CUBsample object to file
named <code class="docutils literal notranslate"><span class="pre">fname</span></code> + <code class="docutils literal notranslate"><span class="pre">cub.sample</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.summary" title="Link to this definition">#</a></dt>
<dd><p>Print the summary of the drawn sample.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-cubmods">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cubmods" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="modules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">cubmods</p>
      </div>
    </a>
    <a class="right-next"
       href="references.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub">cubmods.cub module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-examples-and-references">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-of-todos">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classes-and-functions">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.CUBresCUB00"><code class="docutils literal notranslate"><span class="pre">CUBresCUB00</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.CUBresCUB00.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUB00.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.CUBresCUB00.plot_confell"><code class="docutils literal notranslate"><span class="pre">CUBresCUB00.plot_confell()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.CUBresCUB00.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUB00.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.cmf"><code class="docutils literal notranslate"><span class="pre">cmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.gini"><code class="docutils literal notranslate"><span class="pre">gini()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.laakso"><code class="docutils literal notranslate"><span class="pre">laakso()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.mean"><code class="docutils literal notranslate"><span class="pre">mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.median"><code class="docutils literal notranslate"><span class="pre">median()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.skew"><code class="docutils literal notranslate"><span class="pre">skew()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.std"><code class="docutils literal notranslate"><span class="pre">std()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.var"><code class="docutils literal notranslate"><span class="pre">var()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub_0w">cubmods.cub_0w module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.CUBresCUB0W"><code class="docutils literal notranslate"><span class="pre">CUBresCUB0W</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.CUBresCUB0W.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUB0W.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.CUBresCUB0W.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUB0W.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.effe01"><code class="docutils literal notranslate"><span class="pre">effe01()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.init_gamma"><code class="docutils literal notranslate"><span class="pre">init_gamma()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_0w.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub_y0">cubmods.cub_y0 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.CUBresCUBY0"><code class="docutils literal notranslate"><span class="pre">CUBresCUBY0</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.CUBresCUBY0.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBY0.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.CUBresCUBY0.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBY0.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.effe10"><code class="docutils literal notranslate"><span class="pre">effe10()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_y0.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub_yw">cubmods.cub_yw module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.CUBresCUBYW"><code class="docutils literal notranslate"><span class="pre">CUBresCUBYW</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.CUBresCUBYW.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBYW.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.CUBresCUBYW.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBYW.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cub_yw.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cube">cubmods.cube module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.CUBresCUBE"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.CUBresCUBE.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.CUBresCUBE.plot3d"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE.plot3d()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.CUBresCUBE.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.betar"><code class="docutils literal notranslate"><span class="pre">betar()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.cmf"><code class="docutils literal notranslate"><span class="pre">cmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.effecube"><code class="docutils literal notranslate"><span class="pre">effecube()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.mean"><code class="docutils literal notranslate"><span class="pre">mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.var"><code class="docutils literal notranslate"><span class="pre">var()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cube_0w0">cubmods.cube_0w0 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.CUBresCUBE0W0"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE0W0</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE0W0.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBE0W0.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.betabinomialxi"><code class="docutils literal notranslate"><span class="pre">betabinomialxi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.effe"><code class="docutils literal notranslate"><span class="pre">effe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_0w0.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cube_ywz">cubmods.cube_ywz module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.CUBresCUBEYWZ"><code class="docutils literal notranslate"><span class="pre">CUBresCUBEYWZ</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBEYWZ.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBEYWZ.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.Qdue"><code class="docutils literal notranslate"><span class="pre">Qdue()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.Quno"><code class="docutils literal notranslate"><span class="pre">Quno()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.auxmat"><code class="docutils literal notranslate"><span class="pre">auxmat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.betabinomial"><code class="docutils literal notranslate"><span class="pre">betabinomial()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cube_ywz.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cubsh">cubmods.cubsh module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.CUBresCUBSH"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSH</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.CUBresCUBSH.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSH.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.CUBresCUBSH.plot3d"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSH.plot3d()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.CUBresCUBSH.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSH.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.cmf"><code class="docutils literal notranslate"><span class="pre">cmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.cmf_delta"><code class="docutils literal notranslate"><span class="pre">cmf_delta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.draw2"><code class="docutils literal notranslate"><span class="pre">draw2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.mean_delta"><code class="docutils literal notranslate"><span class="pre">mean_delta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.pi1pi2_to_pidelta"><code class="docutils literal notranslate"><span class="pre">pi1pi2_to_pidelta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.pidelta_to_pi1pi2"><code class="docutils literal notranslate"><span class="pre">pidelta_to_pi1pi2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.plot_simplex"><code class="docutils literal notranslate"><span class="pre">plot_simplex()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.pmf_delta"><code class="docutils literal notranslate"><span class="pre">pmf_delta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.proba_delta"><code class="docutils literal notranslate"><span class="pre">proba_delta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.std_delta"><code class="docutils literal notranslate"><span class="pre">std_delta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.var_delta"><code class="docutils literal notranslate"><span class="pre">var_delta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh.varcov_pxd"><code class="docutils literal notranslate"><span class="pre">varcov_pxd()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cubsh_ywx">cubmods.cubsh_ywx module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSHYWX</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSHYWX.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUBSHYWX.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.Q1"><code class="docutils literal notranslate"><span class="pre">Q1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.Q2"><code class="docutils literal notranslate"><span class="pre">Q2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cubsh_ywx.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush">cubmods.cush module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.CUBresCUSH"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.CUBresCUSH.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.CUBresCUSH.plot_estim"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH.plot_estim()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.CUBresCUSH.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.LRT"><code class="docutils literal notranslate"><span class="pre">LRT()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.gini"><code class="docutils literal notranslate"><span class="pre">gini()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.laakso"><code class="docutils literal notranslate"><span class="pre">laakso()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.mean"><code class="docutils literal notranslate"><span class="pre">mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush.var"><code class="docutils literal notranslate"><span class="pre">var()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush2">cubmods.cush2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.CUBresCUSH2"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.CUBresCUSH2.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.CUBresCUSH2.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2.plot_ordinal()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.CUBresCUSH2.plot_par_space"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2.plot_par_space()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2.varcov"><code class="docutils literal notranslate"><span class="pre">varcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush2_x0">cubmods.cush2_x0 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.CUBresCUSH2X0"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2X0</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2X0.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2X0.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.effe"><code class="docutils literal notranslate"><span class="pre">effe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_x0.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush2_xx">cubmods.cush2_xx module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id58">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id59">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id60">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id62">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.CUBresCUSH2XX"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2XX</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2XX.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUSH2XX.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.effe"><code class="docutils literal notranslate"><span class="pre">effe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush2_xx.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush_x">cubmods.cush_x module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id63">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id64">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id66">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.CUBresCUSHX"><code class="docutils literal notranslate"><span class="pre">CUBresCUSHX</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.CUBresCUSHX.plot"><code class="docutils literal notranslate"><span class="pre">CUBresCUSHX.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.CUBresCUSHX.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresCUSHX.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.effe"><code class="docutils literal notranslate"><span class="pre">effe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.cush_x.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.gem">cubmods.gem module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id68">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id69">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id70">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id71">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id72">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.gem.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.gem.estimate"><code class="docutils literal notranslate"><span class="pre">estimate()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.general">cubmods.general module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id73">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id74">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id75">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id76">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.InvalidCategoriesError"><code class="docutils literal notranslate"><span class="pre">InvalidCategoriesError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.InvalidSampleSizeError"><code class="docutils literal notranslate"><span class="pre">InvalidSampleSizeError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.NoShelterError"><code class="docutils literal notranslate"><span class="pre">NoShelterError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.NotImplementedModelError"><code class="docutils literal notranslate"><span class="pre">NotImplementedModelError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.ParameterOutOfBoundsError"><code class="docutils literal notranslate"><span class="pre">ParameterOutOfBoundsError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.ShelterGreaterThanM"><code class="docutils literal notranslate"><span class="pre">ShelterGreaterThanM</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.UnknownModelError"><code class="docutils literal notranslate"><span class="pre">UnknownModelError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.addones"><code class="docutils literal notranslate"><span class="pre">addones()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.aic"><code class="docutils literal notranslate"><span class="pre">aic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.bic"><code class="docutils literal notranslate"><span class="pre">bic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.bitgamma"><code class="docutils literal notranslate"><span class="pre">bitgamma()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.bitxi"><code class="docutils literal notranslate"><span class="pre">bitxi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.choices"><code class="docutils literal notranslate"><span class="pre">choices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.colsof"><code class="docutils literal notranslate"><span class="pre">colsof()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.conf_border"><code class="docutils literal notranslate"><span class="pre">conf_border()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.conf_ell"><code class="docutils literal notranslate"><span class="pre">conf_ell()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.dissimilarity"><code class="docutils literal notranslate"><span class="pre">dissimilarity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.dummies2"><code class="docutils literal notranslate"><span class="pre">dummies2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.equal3d"><code class="docutils literal notranslate"><span class="pre">equal3d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.expit"><code class="docutils literal notranslate"><span class="pre">expit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.formula_parser"><code class="docutils literal notranslate"><span class="pre">formula_parser()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.freq"><code class="docutils literal notranslate"><span class="pre">freq()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.get_cov_ellipsoid"><code class="docutils literal notranslate"><span class="pre">get_cov_ellipsoid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.get_minor"><code class="docutils literal notranslate"><span class="pre">get_minor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.hadprod"><code class="docutils literal notranslate"><span class="pre">hadprod()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.kkk"><code class="docutils literal notranslate"><span class="pre">kkk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.load_object"><code class="docutils literal notranslate"><span class="pre">load_object()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.logis"><code class="docutils literal notranslate"><span class="pre">logis()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.logit"><code class="docutils literal notranslate"><span class="pre">logit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.lsat"><code class="docutils literal notranslate"><span class="pre">lsat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.luni"><code class="docutils literal notranslate"><span class="pre">luni()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.plot_ellipsoid"><code class="docutils literal notranslate"><span class="pre">plot_ellipsoid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.probbit"><code class="docutils literal notranslate"><span class="pre">probbit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.general.unique"><code class="docutils literal notranslate"><span class="pre">unique()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.ihg">cubmods.ihg module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id77">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id78">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id79">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id80">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id81">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.CUBresIHG"><code class="docutils literal notranslate"><span class="pre">CUBresIHG</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.CUBresIHG.plot"><code class="docutils literal notranslate"><span class="pre">CUBresIHG.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.CUBresIHG.plot_estim"><code class="docutils literal notranslate"><span class="pre">CUBresIHG.plot_estim()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.CUBresIHG.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresIHG.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.effe"><code class="docutils literal notranslate"><span class="pre">effe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg.var"><code class="docutils literal notranslate"><span class="pre">var()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.ihg_v">cubmods.ihg_v module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id82">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id83">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id84">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id85">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id86">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.CUBresIHGV"><code class="docutils literal notranslate"><span class="pre">CUBresIHGV</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.CUBresIHGV.plot"><code class="docutils literal notranslate"><span class="pre">CUBresIHGV.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.CUBresIHGV.plot_ordinal"><code class="docutils literal notranslate"><span class="pre">CUBresIHGV.plot_ordinal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.effe"><code class="docutils literal notranslate"><span class="pre">effe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.init_theta"><code class="docutils literal notranslate"><span class="pre">init_theta()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.loglik"><code class="docutils literal notranslate"><span class="pre">loglik()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.mle"><code class="docutils literal notranslate"><span class="pre">mle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.pmf"><code class="docutils literal notranslate"><span class="pre">pmf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.pmfi"><code class="docutils literal notranslate"><span class="pre">pmfi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.ihg_v.prob"><code class="docutils literal notranslate"><span class="pre">prob()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.multicub">cubmods.multicub module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id87">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id88">Manual, Examples and References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id89">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id90">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id91">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.multicub.multi"><code class="docutils literal notranslate"><span class="pre">multi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.multicub.pos_kwargs"><code class="docutils literal notranslate"><span class="pre">pos_kwargs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.smry">cubmods.smry module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id92">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id93">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id94">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id95">Classes and Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBres"><code class="docutils literal notranslate"><span class="pre">CUBres</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBres.as_dataframe"><code class="docutils literal notranslate"><span class="pre">CUBres.as_dataframe()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBres.as_txt"><code class="docutils literal notranslate"><span class="pre">CUBres.as_txt()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBres.save"><code class="docutils literal notranslate"><span class="pre">CUBres.save()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBres.summary"><code class="docutils literal notranslate"><span class="pre">CUBres.summary()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBsample"><code class="docutils literal notranslate"><span class="pre">CUBsample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBsample.as_dataframe"><code class="docutils literal notranslate"><span class="pre">CUBsample.as_dataframe()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBsample.plot"><code class="docutils literal notranslate"><span class="pre">CUBsample.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBsample.save"><code class="docutils literal notranslate"><span class="pre">CUBsample.save()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cubmods.smry.CUBsample.summary"><code class="docutils literal notranslate"><span class="pre">CUBsample.summary()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/cubmods.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Massimo Pierini.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>