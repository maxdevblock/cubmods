

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>cubmods package &#8212; CUBmods 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cubmods';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="cubmods" href="modules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">CUBmods 0.0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="modules.html">
                        cubmods
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="modules.html">
                        cubmods
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">cubmods package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="modules.html" class="nav-link">cubmods</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">cubmods package</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="cubmods-package">
<h1>cubmods package<a class="headerlink" href="#cubmods-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-cubmods.cub">
<span id="cubmods-cub-module"></span><h2>cubmods.cub module<a class="headerlink" href="#module-cubmods.cub" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial).</p>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r|\pmb{\theta}) = \pi \dbinom{m-1}{r-1}(1-\xi)^{r-1}\xi^{m-r}+\dfrac{1-\pi}{m}\)</span></p>
</div></blockquote>
</section>
<section id="manual-and-examples">
<h3>Manual and Examples<a class="headerlink" href="#manual-and-examples" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/02_cub_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="list-of-todos">
<h3>List of TODOs:<a class="headerlink" href="#list-of-todos" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">CUBresCUB00</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub.CUBresCUB00.plot" title="cubmods.cub.CUBresCUB00.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub.CUBresCUB00.plot_confell" title="cubmods.cub.CUBresCUB00.plot_confell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_confell</span></code></a>([figsize, ci, equal, ...])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic confidence ellipse.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub.CUBresCUB00.plot_ordinal" title="cubmods.cub.CUBresCUB00.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, kind, ax, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability mass and, if provided, probability mass of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00.plot_confell">
<span class="sig-name descname"><span class="pre">plot_confell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00.plot_confell" title="Permalink to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic confidence ellipse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipse</p></li>
<li><p><strong>equal</strong> (<em>bool</em>) – if the plot must have equal aspect</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub.CUBresCUB00.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.CUBresCUB00.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability mass and,
if provided, probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.cmf" title="Permalink to this definition">#</a></dt>
<dd><p>Cumulative probability of a specified CUB model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \geq r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of the CMF for the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.gini">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">gini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.gini" title="Permalink to this definition">#</a></dt>
<dd><p>The Gini index of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Gini index of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.init_theta" title="Permalink to this definition">#</a></dt>
<dd><p>Preliminary estimators for CUB models without covariates.</p>
<p>Computes preliminary parameter estimates of a CUB model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array of int</em>) – array of the absolute frequencies of given ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi^{(0)}, \xi^{(0)})\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.laakso">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">laakso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.laakso" title="Permalink to this definition">#</a></dt>
<dd><p>The Laakso index of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Laakso index of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the log-likelihood function of a CUB model without 
covariates for a given absolute frequency distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>f</strong> (<em>array of int</em>) – array of absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.mean" title="Permalink to this definition">#</a></dt>
<dd><p>Expected value of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.mean_diff">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">mean_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.mean_diff" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.median">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.median" title="Permalink to this definition">#</a></dt>
<dd><p>The median of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the median of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUB models without covariates.</p>
<p>Function to estimate and validate a CUB model without covariates for given ordinal responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUB00</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUB model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution of a CUB model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.proba">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.proba" title="Permalink to this definition">#</a></dt>
<dd><p>Probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>r</strong> (<em>int</em>) – ordinal value (must be <span class="math notranslate nohighlight">\(1 \leq r \leq m\)</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.skew">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.skew" title="Permalink to this definition">#</a></dt>
<dd><p>Skewness normalized <span class="math notranslate nohighlight">\(\eta\)</span> index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the skewness of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.std">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.std" title="Permalink to this definition">#</a></dt>
<dd><p>Standard deviation of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the standard deviation of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.var" title="Permalink to this definition">#</a></dt>
<dd><p>Variance of a specified CUB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordinal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the variance-covariance matrix of parameter 
estimates of a CUB model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>ordinal</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cub_0w">
<span id="cubmods-cub-0w-module"></span><h2>cubmods.cub_0w module<a class="headerlink" href="#module-cubmods.cub_0w" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial) with covariates for the feeling component.</p>
<section id="id1">
<h3>Description:<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_0W model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r_i|\pmb{\theta}_i ; \pmb w_i) = \pi \dbinom{m-1}{r_i-1}(1-\xi_i)^{r_i-1}\xi_i^{m-r_i}+\dfrac{1-\pi}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(\xi_i = \dfrac{1}{1+e^{-\pmb w_i \pmb\gamma}}\)</span></p>
</div></blockquote>
</section>
<section id="id2">
<h3>Manual and Examples<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/02_cub_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id3">
<h3>References:<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id4">
<h3>List of TODOs:<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub_0w.CUBresCUB0W">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">CUBresCUB0W</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.CUBresCUB0W" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub_0w.CUBresCUB0W.plot" title="cubmods.cub_0w.CUBresCUB0W.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub_0w.CUBresCUB0W.plot_ordinal" title="cubmods.cub_0w.CUBresCUB0W.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability mass and, if provided, average probability mass of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_0w.CUBresCUB0W.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.CUBresCUB0W.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_0w.CUBresCUB0W.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.CUBresCUB0W.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability mass and,
if provided, average probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.cmf" title="Permalink to this definition">#</a></dt>
<dd><p>Average cumulative probability of a specified CUB model
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \geq r | \pmb\theta_i ; \pmb w_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the cumulative probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model with covariates for
the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None;
it must be <span class="math notranslate nohighlight">\(\neq 0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.effe01">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">effe01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.effe01" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUB models
with covariates for the feeling component.</p>
<p>Compute the opposite of the scalar function that is maximized when running 
the E-M algorithm for CUB models with covariates for the feeling parameter.</p>
<p>It is called as an argument for <code class="docutils literal notranslate"><span class="pre">minimize</span></code> within CUB function for models with covariates for
feeling or for both feeling and uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>esterno01</strong> – a matrix binding together: the vector <span class="math notranslate nohighlight">\(\pmb\tau\)</span> of the posterior probabilities
that each observation has been generated by the first component distribution of the mixture, 
the ordinal data <span class="math notranslate nohighlight">\(\pmb r\)</span> and the matrix <span class="math notranslate nohighlight">\(\pmb w\)</span> of the selected covariates 
accounting for an intercept term</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the inconplete log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.init_gamma">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">init_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.init_gamma" title="Permalink to this definition">#</a></dt>
<dd><p>Preliminary parameter estimates of a CUB model with covariates for the feeling component.</p>
<p>Compute preliminary parameter estimates for the feeling component of a CUB model 
fitted to ordinal responses.
These estimates are set as initial values for parameters to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array <span class="math notranslate nohighlight">\(\pmb\gamma^{(0)}\)</span> of size <span class="math notranslate nohighlight">\(\pmb w + 1\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUB model with covariates for the feeling component</p>
<p>Compute the log-likelihood function of a CUB model fitting ordinal data, with
covariates for explaining the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUB models with covariates for the feeling component.</p>
<p>Function to estimate and validate a CUB model for given ordinal responses, with covariates for
explaining the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUB0W</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Average Probability Mass of a specified CUB model 
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R = r | \pmb\theta_i ; \pmb w_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.pmfi" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUB model 
with covariates for the feeling component.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta_i ; \pmb w_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.prob" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of a CUB model with covariates for the feeling component
given an observed sample</p>
<p>Compute the probability distribution of a CUB model with covariates
for the feeling component, given an observed sample.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r_i | \pmb\theta_i ; \pmb w_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_0w.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_0w.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_0w.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of CUB models with covariates for the feeling component</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model
with covariates for the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cub_y0">
<span id="cubmods-cub-y0-module"></span><h2>cubmods.cub_y0 module<a class="headerlink" href="#module-cubmods.cub_y0" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial) with covariates for the uncertainty component.</p>
<section id="id5">
<h3>Description:<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_Y0 model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r_i|\pmb{\theta}_i ; \pmb y_i) = \pi_i \dbinom{m-1}{r_i-1}(1-\xi)^{r_i-1}\xi^{m-r_i}+\dfrac{1-\pi_i}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(\pi_i = \dfrac{1}{1+e^{-\pmb y_i \pmb\beta}}\)</span></p>
</div></blockquote>
</section>
<section id="id6">
<h3>Manual and Examples<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/02_cub_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id7">
<h3>References:<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id8">
<h3>List of TODOs:<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub_y0.CUBresCUBY0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBY0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.CUBresCUBY0" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub_y0.CUBresCUBY0.plot" title="cubmods.cub_y0.CUBresCUBY0.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub_y0.CUBresCUBY0.plot_ordinal" title="cubmods.cub_y0.CUBresCUBY0.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability mass and, if provided, average probability mass of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_y0.CUBresCUBY0.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.CUBresCUBY0.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_y0.CUBresCUBY0.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.CUBresCUBY0.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability mass and,
if provided, average probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model with covariates for
the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None;
it must be <span class="math notranslate nohighlight">\(\neq 0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.effe10">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">effe10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.effe10" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUB models.</p>
<p>Compute the opposite of the scalar function that is maximized when running
the E-M algorithm for CUB models with covariates for the uncertainty parameter.</p>
<dl class="simple">
<dt>It is called as an argument for optim within CUB function for models with covariates for</dt><dd><p>uncertainty or for both feeling and uncertainty.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>esterno10</strong> – A matrix binding together: the matrix <span class="math notranslate nohighlight">\(\pmb y\)</span> of the selected covariates  
(accounting for an intercept term) and a vector <span class="math notranslate nohighlight">\(\tau\)</span> (whose length equals the number of observations) 
of the posterior probabilities that each observation has been generated by the first component 
distribution of the mixture</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the inconplete log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUB model with covariates for the uncertainty component</p>
<p>Compute the log-likelihood function of a CUB model fitting ordinal responses with covariates 
for explaining the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUB models with covariates for the uncertainty component.</p>
<p>Estimate and validate a CUB model for given ordinal responses, with covariates for explaining 
the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBY0</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Average Probability Mass of a specified CUB model 
with covariates.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R = r | \pmb\theta_i ; \pmb w_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.pmfi" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUB model 
with covariates.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta_i ; \pmb y_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.prob" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of a CUB model with covariates for the uncertainty component
given an observed sample</p>
<p>Compute the probability distribution of a CUB model with covariates
for the feeling component, given an observed sample.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r_i | \pmb\theta_i ; \pmb w_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_y0.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_y0.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_y0.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of CUB model with covariates for the uncertainty parameter.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with 
covariates for the uncertainty component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cub_yw">
<span id="cubmods-cub-yw-module"></span><h2>cubmods.cub_yw module<a class="headerlink" href="#module-cubmods.cub_yw" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUB (Combination of Uniform
and Binomial) with covariates
for both feeling and uncertainty.</p>
<section id="id9">
<h3>Description:<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_YW model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r_i|\pmb{\theta}_i ; \pmb y_i ; \pmb w_i) = \pi_i \dbinom{m-1}{r_i-1}(1-\xi_i)^{r_i-1}\xi_i^{m-r_i}+\dfrac{1-\pi_i}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(\xi_i = \dfrac{1}{1+e^{-\pmb w_i \pmb\gamma}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\pi_i = \dfrac{1}{1+e^{-\pmb y_i \pmb\beta}}\)</span></p>
</div></blockquote>
</section>
<section id="id10">
<h3>Manual and Examples<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/02_cub_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id11">
<h3>References:<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id12">
<h3>List of TODOs:<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cub_yw.CUBresCUBYW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBYW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.CUBresCUBYW" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>“Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cub_yw.CUBresCUBYW.plot" title="cubmods.cub_yw.CUBresCUBYW.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cub_yw.CUBresCUBYW.plot_ordinal" title="cubmods.cub_yw.CUBresCUBYW.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability mass and, if provided, average probability mass of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_yw.CUBresCUBYW.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.CUBresCUBYW.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cub_yw.CUBresCUBYW.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.CUBresCUBYW.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability mass and,
if provided, average probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUB model with covariates for
both feeling and uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUB model with covariates for both feeling and uncertainty.</p>
<p>Compute the log-likelihood function of a CUB model fitting ordinal data
with covariates for explaining both the feeling and the uncertainty components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUB models with covariates for both the uncertainty and the feeling components.</p>
<p>Estimate and validate a CUB model for given ordinal responses, with covariates for explaining both the
feeling and the uncertainty components by means of logistic transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBYW</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Average Probability Mass of a specified CUB model 
with covariates for both feeling and uncertainty.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R = r | \pmb\theta_i ; \pmb w_i; \pmb y_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.pmfi" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUB model 
with covariates for both feeling and uncertainty.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta_i ; \pmb y_i; \pmb w_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.prob" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of a CUB model with covariates for both feeling and uncertainty.</p>
<p>Compute the probability distribution of a CUB model with covariates for both the feeling 
and the uncertainty components.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r_i | \pmb\theta_i ; \pmb w_i; \pmb y_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cub_yw.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cub_yw.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cub_yw.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of a CUB model with covariates for both uncertainty and feeling.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with covariates for
both the uncertainty and the feeling components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUB model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cube">
<span id="cubmods-cube-module"></span><h2>cubmods.cube module<a class="headerlink" href="#module-cubmods.cube" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBE (Combination of Uniform
and Beta-Binomial).</p>
<section id="id13">
<h3>Description:<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBE model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r|\pmb{\theta}) = \pi \mathrm{Beta}(\xi,\phi)+\dfrac{1-\pi}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(\xi = \dfrac{\beta}{\alpha+\beta}\)</span></p>
<p><span class="math notranslate nohighlight">\(\phi = \dfrac{1}{\alpha+\beta}\)</span></p>
</div></blockquote>
</section>
<section id="id14">
<h3>Manual and Examples<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/03_cube_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id15">
<h3>References:<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id16">
<h3>List of TODOs:<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: adjust 3d plots legend</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube.CUBresCUBE.plot" title="cubmods.cube.CUBresCUBE.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, confell, test3, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cube.CUBresCUBE.plot3d" title="cubmods.cube.CUBresCUBE.plot3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot3d</span></code></a>(ax[, ci, magnified])</p></td>
<td><p>Plots the estimated parameter values in the parameter space and the asymptotic confidence ellipsoid with its projections.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube.CUBresCUBE.plot_ordinal" title="cubmods.cube.CUBresCUBE.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative frequencies of observed sample, estimated probability mass and, if provided, probability mass of a known model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipsoid</p></li>
<li><p><strong>confell</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to False</p></li>
<li><p><strong>test3</strong> (<em>bool</em>) – <strong>DEPRECATED</strong>, defaults to True</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE.plot3d" title="Permalink to this definition">#</a></dt>
<dd><p>Plots the estimated parameter values in the parameter space and
the asymptotic confidence ellipsoid with its projections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci</strong> (<em>float</em>) – level <span class="math notranslate nohighlight">\((1-\alpha/2)\)</span> for the confidence ellipsoid</p></li>
<li><p><strong>magnified</strong> (<em>bool</em>) – if False the limits will be the entire parameter space, otherwise let matplotlib choose the limits</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube.CUBresCUBE.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.CUBresCUBE.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative frequencies of observed sample, estimated probability mass and,
if provided, probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.betar">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">betar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.betar" title="Permalink to this definition">#</a></dt>
<dd><p>Beta-Binomial distribution.</p>
<p>Return the Beta-Binomial distribution with given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of length <span class="math notranslate nohighlight">\(m\)</span> of the Beta-Binomial distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.cmf" title="Permalink to this definition">#</a></dt>
<dd><p>Cumulative probability of a specified CUBE model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R \geq r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of length <span class="math notranslate nohighlight">\(m\)</span> of the cumulative probability of a CUBE model without covariates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.effecube">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">effecube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.effecube" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models without covariates.</p>
<p>Define the opposite of the scalar function that is maximized when running the E-M 
algorithm for CUBE models without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>array of float</em>) – array of initial estimates for the feeling and the overdispersion parameters</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – a column vector of length <span class="math notranslate nohighlight">\(m\)</span> containing the posterior
probabilities that each observed category has been generated by the first component distribution 
of the mixture</p></li>
<li><p><strong>f</strong> (<em>array</em>) – array of the absolute frequencies of the observations</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the inconplete log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.init_theta" title="Permalink to this definition">#</a></dt>
<dd><p>Naive estimates for CUBE models without covariates.</p>
<p>Compute naive parameter estimates of a CUBE model without covariates for given ordinal responses. 
These preliminary estimators are used within the package code to start the E-M algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi^{(0)}, \xi^{(0)}, \phi^{(0)})\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUBE model without covariates.</p>
<p>Compute the log-likelihood function of a CUBE model without covariates fitting 
the given absolute frequency distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>f</strong> (<em>array of int</em>) – array of absolute frequency distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.mean" title="Permalink to this definition">#</a></dt>
<dd><p>Mean of a CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expected value of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUBE models without covariates.</p>
<p>Estimate and validate a CUBE model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBE</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of a specified CUBE model.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of length <span class="math notranslate nohighlight">\(m\)</span> of the distribution of a CUBE model without covariates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.proba">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.proba" title="Permalink to this definition">#</a></dt>
<dd><p>Probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a CUBE model without covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>r</strong> (<em>int</em>) – ordinal response</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the probability <span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta)\)</span> of a CUBE model without covariates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.var" title="Permalink to this definition">#</a></dt>
<dd><p>Variance of a CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>Variance-covariance matrix for CUBE models based on the observed information matrix.</p>
<p>Compute the variance-covariance matrix of parameter estimates for a CUBE model without covariates 
as the inverse of the observed information matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix of the CUBE model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cube_0w0">
<span id="cubmods-cube-0w0-module"></span><h2>cubmods.cube_0w0 module<a class="headerlink" href="#module-cubmods.cube_0w0" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBE (Combination of Uniform
and Beta-Binomial) with covariates for the feeling component.</p>
<section id="id17">
<h3>Description:<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBE_0W0 model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r|\pmb{\theta}) = \pi \mathrm{Beta}(\xi,\phi)+\dfrac{1-\pi}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(\xi = \dfrac{\beta}{\alpha+\beta} = \dfrac{1}{1+e^{-\pmb w_i \pmb \gamma}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\phi = \dfrac{1}{\alpha+\beta}\)</span></p>
</div></blockquote>
</section>
<section id="id18">
<h3>Manual and Examples<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/03_cube_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id19">
<h3>References:<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id20">
<h3>List of TODOs:<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual and Examples</p></li>
<li><p>Remove unused imports</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cube_0w0.CUBresCUBE0W0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBE0W0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.CUBresCUBE0W0" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot" title="cubmods.cube_0w0.CUBresCUBE0W0.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal" title="cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability mass and, if provided, average probability mass of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_0w0.CUBresCUBE0W0.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.CUBresCUBE0W0.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability mass and,
if provided, average probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.betabinomialxi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">betabinomialxi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xivett</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.betabinomialxi" title="Permalink to this definition">#</a></dt>
<dd><p>Beta-Binomial probabilities of ordinal responses, given feeling parameter for each observation.</p>
<p>Compute the Beta-Binomial probabilities of given ordinal responses, with feeling 
parameter specified for each observation, 
and with the same overdispersion parameter for all the responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array</em>) – array of ordinal responses. Missing values are not allowed: they should be preliminarily deleted</p></li>
<li><p><strong>xivett</strong> (<em>array</em>) – array of feeling parameters of the Beta-Binomial distribution for given ordinal responses</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of the same length as ordinal: each entry is the Beta-Binomial probability for the given observation 
for the corresponding feeling and overdispersion parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.effe" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates 
only for the feeling component.</p>
<p>Compute the opposite of the scalar function that is maximized when running the 
E-M algorithm for CUBE models with covariates only for the feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of length equal to <code class="docutils literal notranslate"><span class="pre">W.index.size+3</span></code> whose entries are the initial parameters estimates</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>negative log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.init_theta" title="Permalink to this definition">#</a></dt>
<dd><p>Preliminary estimates of parameters for CUBE models with covariates only for feeling.</p>
<p>Compute preliminary parameter estimates of a CUBE model with covariates only for feeling, given
ordinal responses. These estimates are set as initial values to start the corresponding E-M algorithm within the package.
Preliminary estimates for the uncertainty and the overdispersion parameters are computed by short runs of EM. 
As to the feeling component, it considers the nested CUB model with covariates and calls code{link{inibestgama}} to derive initial estimates for the coefficients
of the selected covariates for feeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for preliminary iterations</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates for preliminary iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pi^{(0)}, \pmb \gamma^{(0)}, \phi^{(0)})\)</span>, where <span class="math notranslate nohighlight">\(\pi^{(0)}\)</span> is the initial 
estimate for the uncertainty parameter, 
<span class="math notranslate nohighlight">\(\pmb \gamma^{(0)}\)</span> is the vector of initial estimates for the feeling component (including an intercept 
term in the first entry),
and <span class="math notranslate nohighlight">\(\phi^{(0)}\)</span> is the initial estimate for the overdispersion parameter.</p>
</dd>
</dl>
<p>“rtype”: tuple</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood function of CUBE model with covariates only for feeling.</p>
<p>Compute the log-likelihood function of a CUBE model for ordinal data with subjects’ 
covariates only for feeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUBE models with covariates only for feeling</p>
<p>Estimate and validate a CUBE model for ordinal data, with covariates only for explaining the
feeling component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for preliminary iterations</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates for preliminary iterations;
the informatio matrix (to compute the variance-covariance matrix) is approximated with <code class="docutils literal notranslate"><span class="pre">approx_hess()</span></code>
(see <code class="docutils literal notranslate"><span class="pre">statsmodels.tools.numdiff</span></code> for details)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBE0W0</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Average Probability Mass of a specified CUB model 
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R = r | \pmb\theta_i ; \pmb w_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the average probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.pmfi" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUBE model 
with covariates for feeling only.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta_i ; \pmb w_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_0w0.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_0w0.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_0w0.prob" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of a CUBE model with covariates for feeling.</p>
<p>Compute the probability distribution of a CUB model with covariates for both the feeling 
and the uncertainty components. Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.loglik()</span></code></p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r_i | \pmb\theta_i ; \pmb w_i),\; i=1 \ldots n\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>pi</strong> (<em>float</em>) – uncertainty parameter <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cube_ywz">
<span id="cubmods-cube-ywz-module"></span><h2>cubmods.cube_ywz module<a class="headerlink" href="#module-cubmods.cube_ywz" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBE (Combination of Uniform
and Beta-Binomial) with covariates.</p>
<section id="id21">
<h3>Description:<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUB_YWZ model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r|\pmb{\theta}) = \pi \mathrm{Beta}(\xi,\phi)+\dfrac{1-\pi}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(\pi = \dfrac{1}{1+e^{-\pmb y_i \pmb \beta}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\xi = \dfrac{\beta}{\alpha+\beta} = \dfrac{1}{1+e^{-\pmb w_i \pmb \gamma}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\phi = \dfrac{1}{\alpha+\beta} = e^{\pmb z_i \pmb \alpha}\)</span></p>
</div></blockquote>
</section>
<section id="id22">
<h3>Manual and Examples<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual <a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/04_cube_family.md">maxdevblock/cubmods</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="id23">
<h3>References:<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id24">
<h3>List of TODOs:<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Manual and Examples</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cube_ywz.CUBresCUBEYWZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBEYWZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.CUBresCUBEYWZ" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p>Object returned by <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function.
See the Base for details.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot" title="cubmods.cube_ywz.CUBresCUBEYWZ.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>Main function to plot an object of the Class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal" title="cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ordinal</span></code></a>([figsize, ax, kind, saveas])</p></td>
<td><p>Plots relative average frequencies of observed sample, estimated average probability mass and, if provided, average probability mass of a known model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_ywz.CUBresCUBEYWZ.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Main function to plot an object of the Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.CUBresCUBEYWZ.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd><p>Plots relative average frequencies of observed sample, estimated average probability mass and,
if provided, average probability mass of a known model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of float</em>) – tuple of <code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">height)</span></code> for the figure (useful only if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not None)</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – choose a barplot (<code class="docutils literal notranslate"><span class="pre">'bar'</span></code> default) of a scatterplot (<code class="docutils literal notranslate"><span class="pre">'scatter'</span></code>)</p></li>
<li><p><strong>ax</strong> (<em>matplolib ax</em><em>, </em><em>optional</em>) – matplotlib axis, if None a new figure will be created, defaults to None</p></li>
<li><p><strong>saveas</strong> (<em>str</em>) – if provided, name of the file to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> or a tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.Qdue">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">Qdue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tauno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.Qdue" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates.</p>
<p>Define the opposite of one of the two scalar functions that are maximized when running the E-M 
algorithm for CUBE models with covariates for feeling, uncertainty and overdispersion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>array</em>) – array of initial estimates of parameters for the feeling component and the overdispersion effect</p></li>
<li><p><strong>tauno</strong> (<em>array</em>) – the column vector of the posterior probabilities that each observed rating
has been generated by the distribution of the first component of the mixture</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.Quno">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">Quno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.Quno" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates.</p>
<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for CUBE models with covariates for feeling, uncertainty and overdispersion.</p>
<p>It is iteratively called as an argument of “optim” within CUBE function (with covariates) as  the function
to minimize to compute the maximum likelihood estimates for the feeling and the overdispersion components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>esterno1</strong> (<em>ndarray</em>) – matrix binding together the column vector of the posterior probabilities
that each observed rating has been generated by the first component distribution of the mixture, with the matrix 
<span class="math notranslate nohighlight">\(\pmb y\)</span> of explicative  variables for the uncertainty component, expanded with a unitary vector in the first column to 
consider also an intercept term</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.auxmat">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">auxmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.auxmat" title="Permalink to this definition">#</a></dt>
<dd><p>Auxiliary matrix.</p>
<p>Returns an auxiliary matrix needed for computing the variance-covariance matrix of a CUBE model with covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>array of float</em>) – feeling parameters <span class="math notranslate nohighlight">\(\pmb\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>array of float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\pmb\phi\)</span></p></li>
<li><p><strong>a</strong><strong>,</strong><strong>b</strong><strong>,</strong><strong>c</strong><strong>,</strong><strong>d</strong><strong>,</strong><strong>e</strong> (<em>float</em>) – see the reference paper <em>DOI: 10.1080/03610926.2013.821487</em> for details</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.betabinomial">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">betabinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.betabinomial" title="Permalink to this definition">#</a></dt>
<dd><p>Beta-Binomial probabilities of ordinal responses, with feeling and overdispersion parameters
for each observation.</p>
<p>Compute the Beta-Binomial probabilities of ordinal responses, given feeling and overdispersion
parameters for each observation.</p>
<p>The Beta-Binomial distribution is the Binomial distribution in which the probability of success at
each trial is random and follows the Beta distribution. It is frequently used in Bayesian 
statistics, empirical Bayes methods and classical statistics as an overdispersed binomial distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
<li><p><strong>phi</strong> (<em>float</em>) – overdispersion parameter <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of the same length as <code class="docutils literal notranslate"><span class="pre">sample</span></code>, containing the Beta-Binomial probabilities of each observation,
for the corresponding feeling and overdispersion parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.draw" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a random sample from a specified CUBE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of ordinal responses to be drawn</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – the <cite>seed</cite> to ensure reproducibility, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of <span class="math notranslate nohighlight">\(n\)</span> ordinal responses drawn from the specified model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.init_theta" title="Permalink to this definition">#</a></dt>
<dd><p>Preliminary parameter estimates for CUBE models with covariates.</p>
<p>Compute preliminary parameter estimates for a CUBE model with covariates for all the three parameters. 
These estimates are set as initial values to start the E-M algorithm within maximum likelihood estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of covariates for the uncertainty component</p></li>
<li><p><strong>v</strong> (<em>int</em>) – number of covariates for the overdispersion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of <span class="math notranslate nohighlight">\((\pmb \beta^{(0)}, \pmb \gamma^{(0)}, \pmb \alpha^{(0)})\)</span> of preliminary estimates of parameter vectors for 
<span class="math notranslate nohighlight">\(\pi = \pi(\pmb{\beta})\)</span>, ; xi=xi(pmb{gamma}),; phi=phi(pmb{alpha})` respectively, of a CUBE model with covariates for all the three
parameters. In details, they have length equal to <code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code>, <code class="docutils literal notranslate"><span class="pre">W.columns.size``+1</span> <span class="pre">and</span>
<span class="pre">``Z.columns.size+1</span></code>, respectively, to account for an intercept term for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.loglik" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood function of a CUBE model with covariates.</p>
<p>Compute the log-likelihood function of a CUBE model for ordinal responses,
with covariates for explaining all the three parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Main function for CUBE models with covariates.</p>
<p>Function to estimate and validate a CUBE model with 
explicative covariates for all the three parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>gen_pars</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – dictionary of hypothesized parameters, defaults to None</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations allowed for running the optimization algorithm</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – fixed error tolerance for final estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <code class="docutils literal notranslate"><span class="pre">CUBresCUBEYWZ</span></code> (see the Class for details)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Average Probability Mass of a specified CUB model 
with covariates for the feeling component.</p>
<p><span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n \Pr(R = r | \pmb\theta_i ; \pmb w_i),\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the array of the average probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.pmfi" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution for each subject of a specified CUBE model 
with covariates.</p>
<p>Auxiliary function of <code class="docutils literal notranslate"><span class="pre">.draw()</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R = r | \pmb\theta_i ; \pmb w_i),\; i=1 \ldots n ,\; r=1 \ldots m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrix of the probability distribution of dimension <span class="math notranslate nohighlight">\(n \times r\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cube_ywz.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cube_ywz.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cube_ywz.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>Variance-covariance matrix of a CUBE model with covariates.</p>
<p>Compute the variance-covariance matrix of parameter estimates of a CUBE model with covariates
for all the three parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>Y</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the uncertainty component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>W</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the feeling component;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>Z</strong> (<em>pandas dataframe</em>) – dataframe of covariates for explaining the overdispersion;
no column must be named <code class="docutils literal notranslate"><span class="pre">0</span></code> nor <code class="docutils literal notranslate"><span class="pre">constant</span></code></p></li>
<li><p><strong>beta</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \beta\)</span> of parameters for the uncertainty component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Y.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>gamma</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \gamma\)</span> of parameters for the feeling component, whose length equals 
<code class="docutils literal notranslate"><span class="pre">W.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
<li><p><strong>alpha</strong> (<em>array of float</em>) – array <span class="math notranslate nohighlight">\(\pmb \alpha\)</span> of parameters for the overdispersion, whose length equals 
<code class="docutils literal notranslate"><span class="pre">Z.columns.size+1</span></code> to include an intercept term in the model (first entry)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the variance-covariance matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cubsh">
<span id="cubmods-cubsh-module"></span><h2>cubmods.cubsh module<a class="headerlink" href="#module-cubmods.cubsh" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBSH (Combination of Uniform
and Binomial with Shelter Effect).</p>
<section id="id25">
<h3>Description:<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBSH model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
<p><span class="math notranslate nohighlight">\(\Pr(R=r|\pmb\theta) = \delta D_r^{(c)} + (1 - \delta)[ \pi b_r(\xi) + (1-\pi)/m ]\)</span></p>
</div></blockquote>
</section>
<section id="id26">
<h3>References:<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id27">
<h3>List of TODOs:<a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>TODO: fix 3d plots legend</p></li>
<li><p>TODO: too long title in CUBsample.plot() ?</p></li>
<li><p>TODO: test all <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">_*():</span></code> (optional functions)</p></li>
</ul>
</div></blockquote>
</section>
<section id="credits">
<h3>Credits<a class="headerlink" href="#credits" title="Permalink to this heading">#</a></h3>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
</section>
<section id="classes-and-functions">
<h3>Classes and Functions<a class="headerlink" href="#classes-and-functions" title="Permalink to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBSH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh.CUBresCUBSH.plot" title="cubmods.cubsh.CUBresCUBSH.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, confell, debug, test3, ...])</p></td>
<td><p>plot CUBSH model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cubsh.CUBresCUBSH.plot_confell" title="cubmods.cubsh.CUBresCUBSH.plot_confell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_confell</span></code></a>([figsize, ci, equal, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot3d</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUBSH model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot3d" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot_confell">
<span class="sig-name descname"><span class="pre">plot_confell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot_confell" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh.CUBresCUBSH.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.CUBresCUBSH.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.cmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.cmf_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">cmf_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.cmf_delta" title="Permalink to this definition">#</a></dt>
<dd><p>CMF of CUBSH model with delta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUBSH model
from pi1 and pi2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.draw2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">draw2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.draw2" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUBSH model
from pi and delta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.init_theta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.lambdeta_to_pidelta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">lambdeta_to_pidelta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.lambdeta_to_pidelta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.mean_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">mean_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.mean_delta" title="Permalink to this definition">#</a></dt>
<dd><p>mean of CUBSH model with delta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pi1pi2_to_pidelta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pi1pi2_to_pidelta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pi1pi2_to_pidelta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pidelta_to_lambdeta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pidelta_to_lambdeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pidelta_to_lambdeta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pidelta_to_pi1pi2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pidelta_to_pi1pi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pidelta_to_pi1pi2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.plot_simplex">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">plot_simplex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi1pi2list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.plot_simplex" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>PMF of CUBSH model with pi1, pi2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.pmf_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">pmf_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.pmf_delta" title="Permalink to this definition">#</a></dt>
<dd><p>PMF of CUBSH model with delta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.proba">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.proba" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.proba_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">proba_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.proba_delta" title="Permalink to this definition">#</a></dt>
<dd><p>probability Pr(R=r) of CUBSH model
with delta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.std_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">std_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.std_delta" title="Permalink to this definition">#</a></dt>
<dd><p>standard deviation of CUB model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.var_delta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">var_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.var_delta" title="Permalink to this definition">#</a></dt>
<dd><p>variance of CUBSH model with delta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>compute asymptotic variance-covariance
of CUBSH estimated parameters
controllare n!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh.varcov_pxd">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh.</span></span><span class="sig-name descname"><span class="pre">varcov_pxd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">de</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh.varcov_pxd" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cubsh2">
<span id="cubmods-cubsh2-module"></span><h2>cubmods.cubsh2 module<a class="headerlink" href="#module-cubmods.cubsh2" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBSH2 (Combination of Uniform
and Binomial with two Shelter Choices).</p>
<section id="id28">
<h3>Description:<a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBSH2 model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import cubsh</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = cubsh.mle(samp.rv, m=7, sh=5s)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id29">
<h3>List of TODOs:<a class="headerlink" href="#id29" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>TODO: check plots</p>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Università degli Studi di Brescia
&#64;Affiliation: Analytics and Data Science for Economics and Management
&#64;Date:        2024
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cubsh2.CUBresCUBSH2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBSH2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.CUBresCUBSH2" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh2.CUBresCUBSH2.plot" title="cubmods.cubsh2.CUBresCUBSH2.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, confell, debug, test3, ...])</p></td>
<td><p>plot CUBSH model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.cubsh2.CUBresCUBSH2.plot_confell" title="cubmods.cubsh2.CUBresCUBSH2.plot_confell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_confell</span></code></a>([figsize, ci, equal, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot3d</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh2.CUBresCUBSH2.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.CUBresCUBSH2.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUBSH model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh2.CUBresCUBSH2.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.CUBresCUBSH2.plot3d" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh2.CUBresCUBSH2.plot_confell">
<span class="sig-name descname"><span class="pre">plot_confell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cubdisp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.CUBresCUBSH2.plot_confell" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh2.CUBresCUBSH2.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.CUBresCUBSH2.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.cmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">cmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.cmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUBSH model
from pi1 and pi2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.draw2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">draw2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.draw2" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUBSH2 model
from pi, delta, and zeta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.gini">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">gini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.gini" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.init_theta" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize parameters for EM
algorithm</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.laakso">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">laakso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.laakso" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.mean" title="Permalink to this definition">#</a></dt>
<dd><p>mean of CUBSH2 model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.mean_diff">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">mean_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.mean_diff" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.median">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.median" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Maximum likelihood estimation of parameters pi1, pi2, pi3, xi
with EM algorithm</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.p123_to_pdz">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">p123_to_pdz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.p123_to_pdz" title="Permalink to this definition">#</a></dt>
<dd><p>pi, delta, zeta from
pi1, pi2, pi3</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.pdz_to_p123">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">pdz_to_p123</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.pdz_to_p123" title="Permalink to this definition">#</a></dt>
<dd><p>pi1, pi2, pi3 from
pi, delta, zeta</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>PMF of CUBSH2 model with pi1, pi2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.proba">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.proba" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.skew">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.skew" title="Permalink to this definition">#</a></dt>
<dd><p>skewness normalized eta index</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.std">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.std" title="Permalink to this definition">#</a></dt>
<dd><p>standard deviation of CUBSH2 model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.var" title="Permalink to this definition">#</a></dt>
<dd><p>variance of CUBSH2 model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.varcov" title="Permalink to this definition">#</a></dt>
<dd><p>compute asymptotic variance-covariance
of CUBSH2 parameters estimators</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2.varcov_pixi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2.</span></span><span class="sig-name descname"><span class="pre">varcov_pixi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2.varcov_pixi" title="Permalink to this definition">#</a></dt>
<dd><p>Variance-covariance of (pi,xi) estimated parameters</p>
</dd></dl>

</section>
</section>
<section id="module-cubmods.cubsh2_ywxu">
<span id="cubmods-cubsh2-ywxu-module"></span><h2>cubmods.cubsh2_ywxu module<a class="headerlink" href="#module-cubmods.cubsh2_ywxu" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBSH2 (Combination of Uniform
and Binomial with two Shelter Choices) with covariates.</p>
<section id="id30">
<h3>Description:<a class="headerlink" href="#id30" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBSH2_YWXU model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>TODO: add example</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id31">
<h3>List of TODOs:<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Università degli Studi di Brescia
&#64;Affiliation: Analytics and Data Science for Economics and Management
&#64;Date:        2024
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBSH2YWXU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU.plot" title="cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.CUBresCUBSH2YWXU.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.Q1">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">Q1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.Q1" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.Q2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">Q2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dati2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.Q2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUB model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.init_theta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.pmfi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.prob" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh2_ywxu.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh2_ywxu.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh2_ywxu.varcov" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cubsh_ywx">
<span id="cubmods-cubsh-ywx-module"></span><h2>cubmods.cubsh_ywx module<a class="headerlink" href="#module-cubmods.cubsh_ywx" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUBSH (Combination of Uniform
and Binomial with Shelter Effect) with covariates.</p>
<section id="id32">
<h3>Description:<a class="headerlink" href="#id32" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUBSH_YWX model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>TODO: add example</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id33">
<h3>List of TODOs:<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.CUBresCUBSHYWX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">CUBresCUBSHYWX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot" title="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.CUBresCUBSHYWX.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.Q1">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">Q1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dati1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.Q1" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.Q2">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">Q2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dati2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.Q2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUB model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.init_theta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.pmfi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.prob" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cubsh_ywx.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cubsh_ywx.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cubsh_ywx.varcov" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cush">
<span id="cubmods-cush-module"></span><h2>cubmods.cush module<a class="headerlink" href="#module-cubmods.cush" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUSH (Combination of Uniform
and Shelter effect).</p>
<section id="id34">
<h3>Description:<a class="headerlink" href="#id34" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import cush</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = cush.mle(samp.rv, m=7, sh=5)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id35">
<h3>List of TODOs:<a class="headerlink" href="#id35" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>TODO: check gini &amp; laakso</p>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush.CUBresCUSH.old_plot" title="cubmods.cush.CUBresCUSH.old_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">old_plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>plot_estim</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.old_plot">
<span class="sig-name descname"><span class="pre">old_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.old_plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.plot" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.plot_estim">
<span class="sig-name descname"><span class="pre">plot_estim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.plot_estim" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush.CUBresCUSH.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.CUBresCUSH.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.LRT">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">LRT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.LRT" title="Permalink to this definition">#</a></dt>
<dd><p>Returns lambda of LRT</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUB model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.gini">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">gini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.gini" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.laakso">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">laakso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.laakso" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.mean">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.mean" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush.var" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cush2">
<span id="cubmods-cush2-module"></span><h2>cubmods.cush2 module<a class="headerlink" href="#module-cubmods.cush2" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for 2-CUSH (Combination of Uniform
and 2 Shelter Choices).</p>
<dl>
<dt>Description:</dt><dd><p>This module contains methods and classes
for 2-CUSH model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</dd>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import cush2</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = cush2.mle(samp.rv, m=7)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>TODO: aggiungere tesi?</p></li>
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
<section id="id36">
<h3>List of TODOs:<a class="headerlink" href="#id36" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2.CUBresCUSH2.plot" title="cubmods.cush2.CUBresCUSH2.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>plot_par_space</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">11)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2.CUBresCUSH2.plot_par_space">
<span class="sig-name descname"><span class="pre">plot_par_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.CUBresCUSH2.plot_par_space" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUB model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.mle" title="Permalink to this definition">#</a></dt>
<dd><p>Maximum Likelihood Estimation of
delta1 and delta2 parameters in
a 2-CUSH model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Probability mass of 2-CUSH model,
Combination of Uniform and 2
Shelter Choices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2.varcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2.</span></span><span class="sig-name descname"><span class="pre">varcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2.varcov" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cush2_x0">
<span id="cubmods-cush2-x0-module"></span><h2>cubmods.cush2_x0 module<a class="headerlink" href="#module-cubmods.cush2_x0" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for 2-CUSH (Combination of Uniform
and 2 Shelter Choices) with covariates.</p>
<section id="id37">
<h3>Description:<a class="headerlink" href="#id37" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for 2-CUSH model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import cush2</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = cush2.mle(samp.rv, m=7)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>TODO: aggiungere tesi?</p></li>
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id38">
<h3>List of TODOs:<a class="headerlink" href="#id38" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush2_x0.CUBresCUSH2X0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH2X0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.CUBresCUSH2X0" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot" title="cubmods.cush2_x0.CUBresCUSH2X0.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_x0.CUBresCUSH2X0.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.CUBresCUSH2X0.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.draw" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_x0.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_x0.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_x0.pmfi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cush2_xx">
<span id="cubmods-cush2-xx-module"></span><h2>cubmods.cush2_xx module<a class="headerlink" href="#module-cubmods.cush2_xx" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for 2-CUSH (Combination of Uniform
and 2 Shelter Choices) with covariates.</p>
<section id="id39">
<h3>Description:<a class="headerlink" href="#id39" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for 2-CUSH model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import cush2</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = cush2.mle(samp.rv, m=7)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>TODO: aggiungere tesi?</p></li>
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id40">
<h3>List of TODOs:<a class="headerlink" href="#id40" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush2_xx.CUBresCUSH2XX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSH2XX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.CUBresCUSH2XX" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot" title="cubmods.cush2_xx.CUBresCUSH2XX.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_xx.CUBresCUSH2XX.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.CUBresCUSH2XX.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.draw" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush2_xx.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush2_xx.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush2_xx.pmfi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cush_x">
<span id="cubmods-cush-x-module"></span><h2>cubmods.cush_x module<a class="headerlink" href="#module-cubmods.cush_x" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for CUSH (Combination of Uniform
and Shelter effect) with covariates.</p>
<section id="id41">
<h3>Description:<a class="headerlink" href="#id41" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for CUSH model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>TODO: add example</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id42">
<h3>List of TODOs:<a class="headerlink" href="#id42" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>TODO: check gini &amp; laakso</p>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.cush_x.CUBresCUSHX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">CUBresCUSHX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.CUBresCUSHX" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.cush_x.CUBresCUSHX.plot" title="cubmods.cush_x.CUBresCUSHX.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush_x.CUBresCUSHX.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.CUBresCUSHX.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.cush_x.CUBresCUSHX.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.CUBresCUSHX.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.draw" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esterno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.pmfi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cush_x.proba">
<span class="sig-prename descclassname"><span class="pre">cubmods.cush_x.</span></span><span class="sig-name descname"><span class="pre">proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cush_x.proba" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.cushk">
<span id="cubmods-cushk-module"></span><h2>cubmods.cushk module<a class="headerlink" href="#module-cubmods.cushk" title="Permalink to this heading">#</a></h2>
<p>TEST module for k-CUSH family.
TODO: k-CUSH theory and implementation
WARNING: DO NOT USE</p>
<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cushk.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.cushk.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cushk.draw" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cushk.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.cushk.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cushk.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cushk.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.cushk.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cushk.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cushk.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.cushk.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cushk.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cushk.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.cushk.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cushk.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.cushk.prob">
<span class="sig-prename descclassname"><span class="pre">cubmods.cushk.</span></span><span class="sig-name descname"><span class="pre">prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.cushk.prob" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-cubmods.gem">
<span id="cubmods-gem-module"></span><h2>cubmods.gem module<a class="headerlink" href="#module-cubmods.gem" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for GEM (Generalized Mixtures).</p>
<section id="id43">
<h3>Description:<a class="headerlink" href="#id43" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for GEM maximum likelihood estimation.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import gem</p>
<p>samp = pd.read_csv(“observed.csv”)
fit = gem.from_formula(</p>
<blockquote>
<div><p>formula=”ordinal~0|0|0”,
model=”cub”,
m=7</p>
</div></blockquote>
<p>)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id44">
<h3>List of TODOs:<a class="headerlink" href="#id44" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>TODO: implement best shelter search</p>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="cubmods.gem.from_formula">
<span class="sig-prename descclassname"><span class="pre">cubmods.gem.</span></span><span class="sig-name descname"><span class="pre">from_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cub'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.gem.from_formula" title="Permalink to this definition">#</a></dt>
<dd><p>Takes a DataFrame as input and calls MLE
based upon given model and formula.</p>
</dd></dl>

</section>
</section>
<section id="module-cubmods.general">
<span id="cubmods-general-module"></span><h2>cubmods.general module<a class="headerlink" href="#module-cubmods.general" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for General functions.</p>
<section id="id45">
<h3>Description:<a class="headerlink" href="#id45" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for general functions.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
</section>
<section id="id46">
<h3>References:<a class="headerlink" href="#id46" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id47">
<h3>List of TODOs:<a class="headerlink" href="#id47" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Massimo Pierini</p>
</dd>
<dt class="field-even">Institution<span class="colon">:</span></dt>
<dd class="field-even"><p>Universitas Mercatorum</p>
</dd>
<dt class="field-odd">Affiliation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Graduand in Statistics &amp; Big Data (L41)</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-24</p>
</dd>
<dt class="field-odd">Credit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Domenico Piccolo, Rosaria Simone</p>
</dd>
<dt class="field-even">Contacts<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
</dd>
</dl>
<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.InvalidCategoriesError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">InvalidCategoriesError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.InvalidCategoriesError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.InvalidSampleSizeError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">InvalidSampleSizeError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.InvalidSampleSizeError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.NoShelterError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">NoShelterError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.NoShelterError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.NotImplementedModelError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">NotImplementedModelError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.NotImplementedModelError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.ParameterOutOfBoundsError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">ParameterOutOfBoundsError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.ParameterOutOfBoundsError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.ShelterGreaterThanM">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">ShelterGreaterThanM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.ShelterGreaterThanM" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="cubmods.general.UnknownModelError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">UnknownModelError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.UnknownModelError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>if m is not suitable for model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.addones">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">addones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.addones" title="Permalink to this definition">#</a></dt>
<dd><p>Expand with a unitary vector in the first column of the given matrix
to consider also an intercept term for CUB models with covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>A</strong> – a matrix to be expanded</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the expanded matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>same of <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.aic">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">aic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.aic" title="Permalink to this definition">#</a></dt>
<dd><p>Akaike Information Criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float</em>) – log-likelihood</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the AIC value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.bic">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">bic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.bic" title="Permalink to this definition">#</a></dt>
<dd><p>Bayesian Information Criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float</em>) – log-likelihood</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of parameters</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the BIC value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.bitgamma">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">bitgamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.bitgamma" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.bitxi">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">bitxi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.bitxi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.choices">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">choices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.choices" title="Permalink to this definition">#</a></dt>
<dd><p>Array of ordinal categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of int from 1 to m</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.colsof">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">colsof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.colsof" title="Permalink to this definition">#</a></dt>
<dd><p>Number of columns of the given
matrix or dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>A</strong> (<em>ndarray</em><em>, </em><em>dataframe</em>) – the matrix or dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.conf_border">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">conf_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.conf_border" title="Permalink to this definition">#</a></dt>
<dd><p>Solution by
<a class="reference external" href="https://gist.github.com/randolf-scholz">https://gist.github.com/randolf-scholz</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.conf_ell">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">conf_ell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.conf_ell" title="Permalink to this definition">#</a></dt>
<dd><p>plot confidence ellipse of estimated
CUB parameters of ci% on ax</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.dissimilarity">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">dissimilarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_est</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.dissimilarity" title="Permalink to this definition">#</a></dt>
<dd><p>Normalized dissimilarity measure.</p>
<p>Compute the normalized dissimilarity measure between observed
relative frequencies and estimated (theoretical) probabilities of a discrete distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_obs</strong> (<em>array</em>) – Vector of observed relative frequencies</p></li>
<li><p><strong>p_est</strong> (<em>array</em>) – Vector of estimated (theoretical) probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numeric value of the dissimilarity index, assessing the distance to a perfect fit.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.dummies">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">dummies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.dummies" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.dummies2">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">dummies2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.dummies2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.equal3d">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">equal3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.equal3d" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.formula_parser">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">formula_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.formula_parser" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.freq">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataframe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.freq" title="Permalink to this definition">#</a></dt>
<dd><p>Absolute frequecies of an
observed sample of ordinal
responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array of int</em>) – array of ordinal responses</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>dataframe</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> return
a DataFrame instead of an array,
defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the absolute frequencies of the observed sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array or dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.get_cov_ellipsoid">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">get_cov_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.get_cov_ellipsoid" title="Permalink to this definition">#</a></dt>
<dd><p>Return the 3d points representing the covariance matrix
cov centred at mu and scaled by the factor nstd.</p>
<p>Plot on your favourite 3d axis. 
Example 1:  ax.plot_wireframe(X,Y,Z,alpha=0.1)
Example 2:  ax.plot_surface(X,Y,Z,alpha=0.1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.get_minor">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">get_minor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.get_minor" title="Permalink to this definition">#</a></dt>
<dd><p>Solution by PaulDong</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.hadprod">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">hadprod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Amat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xvett</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.hadprod" title="Permalink to this definition">#</a></dt>
<dd><p>Hadamard’s product between a matrix
(r,c) and a vector (r,1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.kkk">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">kkk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.kkk" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.lbin">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">lbin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.lbin" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.load_object">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">load_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.load_object" title="Permalink to this definition">#</a></dt>
<dd><p>Load a saved object from file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.logis">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">logis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.logis" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.lsat">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">lsat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.lsat" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.lsatcov">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">lsatcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.lsatcov" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.luni">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">luni</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.luni" title="Permalink to this definition">#</a></dt>
<dd><p>Log-likelihood of null model.</p>
<p>Null level, that is when no 
structure is searched for. 
Specifically, this is equivalent to 
assume a discrete Uniform over 
the support so that any category 
has the same probability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the log-likelihood of null model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.plot_ellipsoid">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">plot_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.plot_ellipsoid" title="Permalink to this definition">#</a></dt>
<dd><p>3d confidence ellipsoid</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.probbit">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">probbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.probbit" title="Permalink to this definition">#</a></dt>
<dd><p>Probability distribution of 
shifted binomial random variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>int</em>) – number of ordinal categories</p></li>
<li><p><strong>xi</strong> (<em>float</em>) – feeling parameter <span class="math notranslate nohighlight">\(\xi\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the vector of the probability 
distribution of a shifted Binomial 
model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.general.unique">
<span class="sig-prename descclassname"><span class="pre">cubmods.general.</span></span><span class="sig-name descname"><span class="pre">unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.general.unique" title="Permalink to this definition">#</a></dt>
<dd><p>unique column names in
covar 3d list</p>
</dd></dl>

</section>
</section>
<section id="module-cubmods.ihg">
<span id="cubmods-ihg-module"></span><h2>cubmods.ihg module<a class="headerlink" href="#module-cubmods.ihg" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for IHG (Inverse HyperGeometric).</p>
<section id="id48">
<h3>Description:<a class="headerlink" href="#id48" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for IHG model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import ihg</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = ihg.mle(samp.rv, m=7)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id49">
<h3>List of TODOs:<a class="headerlink" href="#id49" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">CUBresIHG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.ihg.CUBresIHG.plot" title="cubmods.ihg.CUBresIHG.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([ci, saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_estim</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">15)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG.plot_estim">
<span class="sig-name descname"><span class="pre">plot_estim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG.plot_estim" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg.CUBresIHG.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.CUBresIHG.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.draw" title="Permalink to this definition">#</a></dt>
<dd><p>generate random sample from CUB model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.init_theta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.pmf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg.var">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg.</span></span><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg.var" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.ihg_v">
<span id="cubmods-ihg-v-module"></span><h2>cubmods.ihg_v module<a class="headerlink" href="#module-cubmods.ihg_v" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for IHG (Inverse HyperGeometric) with covariates.</p>
<dl>
<dt>Description:</dt><dd><p>This module contains methods and classes
for IHG model family.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</dd>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import ihg</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = ihg.mle(samp.rv, m=7)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>TODO: aggiungere tesi?</p></li>
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
<section id="id50">
<h3>List of TODOs:<a class="headerlink" href="#id50" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.ihg_v.CUBresIHGV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">CUBresIHGV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.CUBresIHGV" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cubmods.smry.CUBres" title="cubmods.smry.CUBres"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUBres</span></code></a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.ihg_v.CUBresIHGV.plot" title="cubmods.ihg_v.CUBresIHGV.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([saveas, figsize])</p></td>
<td><p>plot CUB model fitted from a sample</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>plot_ordinal</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg_v.CUBresIHGV.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.CUBresIHGV.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plot CUB model fitted from a sample</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.ihg_v.CUBresIHGV.plot_ordinal">
<span class="sig-name descname"><span class="pre">plot_ordinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.CUBresIHGV.plot_ordinal" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.draw">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.draw" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.effe">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">effe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.effe" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.init_theta">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">init_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.init_theta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.loglik">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.loglik" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.mle">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.mle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.pmf">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.pmf" title="Permalink to this definition">#</a></dt>
<dd><p>Test pmf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.pmfi">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">pmfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.pmfi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.ihg_v.probi">
<span class="sig-prename descclassname"><span class="pre">cubmods.ihg_v.</span></span><span class="sig-name descname"><span class="pre">probi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.ihg_v.probi" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="module-cubmods.multicub">
<span id="cubmods-multicub-module"></span><h2>cubmods.multicub module<a class="headerlink" href="#module-cubmods.multicub" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for MULTICUB and MULTICUBE.</p>
<section id="id51">
<h3>Description:<a class="headerlink" href="#id51" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for MULTICUB and MULTICUBE tool.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import multicub</p>
<p>TODO: add MULTICUB example</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  old{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id52">
<h3>List of TODOs:<a class="headerlink" href="#id52" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>…</p></li>
</ul>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="cubmods.multicub.multi">
<span class="sig-prename descclassname"><span class="pre">cubmods.multicub.</span></span><span class="sig-name descname"><span class="pre">multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cub'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.multicub.multi" title="Permalink to this definition">#</a></dt>
<dd><p>ords: DataFrame
ms:   list of m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.multicub.pos_kwargs">
<span class="sig-prename descclassname"><span class="pre">cubmods.multicub.</span></span><span class="sig-name descname"><span class="pre">pos_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.multicub.pos_kwargs" title="Permalink to this definition">#</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>1</p>
</div></blockquote>
<p>8   2</p>
</div></blockquote>
<dl class="simple">
<dt>7   &#64;   3</dt><dd><dl class="simple">
<dt>6   4</dt><dd><p>5</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-cubmods.smry">
<span id="cubmods-smry-module"></span><h2>cubmods.smry module<a class="headerlink" href="#module-cubmods.smry" title="Permalink to this heading">#</a></h2>
<p>CUB models in Python.
Module for summary tools.</p>
<section id="id53">
<h3>Description:<a class="headerlink" href="#id53" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>This module contains methods and classes
for summary tools.
It is based upon the works of Domenico
Piccolo et Al. and CUB package in R.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>import pandas as pd
import matplotlib.pyplot as plt
from cubmods import cub</p>
<p>samp = pd.read_csv(“ordinal.csv”)
fit = cub.mle(samp.rv, m=7)
print(fit.summary())
fit.plot()
plt.show()</p>
</dd>
</dl>
<p>…
References:
===========</p>
<blockquote>
<div><ul class="simple">
<li><p>D’Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution, Statistical Modelling: an International Journal, 3, 65–78</p></li>
<li><p>D’Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis, Computational Statistics &amp; Data Analysis},  bold{49, 917–937</p></li>
<li><p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses, Quality and Quantity, 51(5), 2375–2393</p></li>
<li><p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data, Communications in Statistics - Theory and Methods, 43, 771–786</p></li>
<li><p>Piccolo D. (2015). Inferential issues for CUBE models with covariates, Communications in Statistics. Theory and Methods, 44(23), 771–786.</p></li>
<li><p>Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means of a mixture distribution, Quality &amp; Quantity, 49, 977–987</p></li>
<li><p>Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data. Metron, 74(2), 233–252.</p></li>
<li><p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data. Statistical Methods and Applications, 25, 163–189.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id54">
<h3>List of TODOs:<a class="headerlink" href="#id54" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p><a href="#id55"><span class="problematic" id="id56">*</span></a>TODO: Correlation su, — invece di === come nella tesi
<a href="#id57"><span class="problematic" id="id58">*</span></a>TODO: loglik invece di loglike
<a href="#id59"><span class="problematic" id="id60">*</span></a>TODO: Corr(pi,xi) invece di Corr(pi, xi) nei plot
<a href="#id61"><span class="problematic" id="id62">*</span></a>TODO: Feeling invece di Preference nei grafici
<a href="#id63"><span class="problematic" id="id64">*</span></a>TODO: barre invece di pallini (aggiungere opzione)
<a href="#id65"><span class="problematic" id="id66">*</span></a>TODO: controllare NAs (e dirlo)
TODO: risultati inferenziali come DataFrame nel Manuale e negli esempi
TODO: User Manual
TODO: Refernce Guide
TODO: bounds opzionali in CUBE mle (anche CUBSH?)
TODO: 2 decimali nei 3d plot?
<a href="#id67"><span class="problematic" id="id68">*</span></a>TODO: stessa unità di misura nei 3d plot magnified?
<a href="#id69"><span class="problematic" id="id70">*</span></a>TODO: titolo con covariate AVERAGE ESTIMATED PROBABILITY
TODO: dissim in multicub plot (aggiungere opzione)
TODO: grandezza punti phi in multicube
<a href="#id71"><span class="problematic" id="id72">*</span></a>TODO: stessi decimali nel summary</p>
</div></blockquote>
<p>&#64;Author:      Massimo Pierini
&#64;Institution: Universitas Mercatorum
&#64;Affiliation: Graduand in Statistics &amp; Big Data (L41)
&#64;Date:        2023-24
&#64;Credit:      Domenico Piccolo, Rosaria Simone
&#64;Contacts:    <a class="reference external" href="mailto:cub&#37;&#52;&#48;maxpierini&#46;it">cub<span>&#64;</span>maxpierini<span>&#46;</span>it</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="cubmods.smry.CUBres">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.smry.</span></span><span class="sig-name descname"><span class="pre">CUBres</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Default Class for MLE results; each model module extends this Class to an ad hoc 
Class with specific functions. An instance of the extended Class is returned by .mle() 
functions of model modules.</p>
<p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.as_dataframe" title="cubmods.smry.CUBres.as_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code></a>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.as_txt" title="cubmods.smry.CUBres.as_txt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_txt</span></code></a>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.save" title="cubmods.smry.CUBres.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(fname)</p></td>
<td><p>Save a CUBresult object to file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBres.summary" title="cubmods.smry.CUBres.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Call as_txt()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.as_dataframe">
<span class="sig-name descname"><span class="pre">as_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.as_dataframe" title="Permalink to this definition">#</a></dt>
<dd><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.as_txt">
<span class="sig-name descname"><span class="pre">as_txt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.as_txt" title="Permalink to this definition">#</a></dt>
<dd><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save a CUBresult object to file</p>
<p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubres">maxdevblock/cubmods</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBres.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBres.summary" title="Permalink to this definition">#</a></dt>
<dd><p>Call as_txt()</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cubmods.smry.</span></span><span class="sig-name descname"><span class="pre">CUBsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theoric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An instance of this Class is returned by .draw() functions. See the corresponding model’s function for details.</p>
<p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.as_dataframe" title="cubmods.smry.CUBsample.as_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_dataframe</span></code></a>([varname])</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.plot" title="cubmods.smry.CUBsample.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([figsize, kind, ax, saveas])</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.save" title="cubmods.smry.CUBsample.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(fname)</p></td>
<td><p>Save a CUBsample object to file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cubmods.smry.CUBsample.summary" title="cubmods.smry.CUBsample.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.as_dataframe">
<span class="sig-name descname"><span class="pre">as_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">varname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ordinal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.as_dataframe" title="Permalink to this definition">#</a></dt>
<dd><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.plot" title="Permalink to this definition">#</a></dt>
<dd><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save a CUBsample object to file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubmods.smry.CUBsample.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.CUBsample.summary" title="Permalink to this definition">#</a></dt>
<dd><p><a class="github reference external" href="https://github.com/maxdevblock/cubmods/blob/main/Manual/Reference%20Guide/smry.md#cubsample">maxdevblock/cubmods</a></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cubmods.smry.as_txt">
<span class="sig-prename descclassname"><span class="pre">cubmods.smry.</span></span><span class="sig-name descname"><span class="pre">as_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wald</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muloglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikuni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logliksatcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_exe</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cubmods.smry.as_txt" title="Permalink to this definition">#</a></dt>
<dd><p>DEPRECATED FUNCTION.</p>
</dd></dl>

</section>
</section>
<section id="module-cubmods">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cubmods" title="Permalink to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="modules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">cubmods</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub">cubmods.cub module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-and-examples">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-of-todos">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub_0w">cubmods.cub_0w module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub_y0">cubmods.cub_y0 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cub_yw">cubmods.cub_yw module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cube">cubmods.cube module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cube_0w0">cubmods.cube_0w0 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cube_ywz">cubmods.cube_ywz module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Manual and Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cubsh">cubmods.cubsh module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">List of TODOs:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classes-and-functions">Classes and Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cubsh2">cubmods.cubsh2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cubsh2_ywxu">cubmods.cubsh2_ywxu module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cubsh_ywx">cubmods.cubsh_ywx module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush">cubmods.cush module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush2">cubmods.cush2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush2_x0">cubmods.cush2_x0 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush2_xx">cubmods.cush2_xx module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cush_x">cubmods.cush_x module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.cushk">cubmods.cushk module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.gem">cubmods.gem module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.general">cubmods.general module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">References:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.ihg">cubmods.ihg module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.ihg_v">cubmods.ihg_v module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.multicub">cubmods.multicub module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods.smry">cubmods.smry module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">Description:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">List of TODOs:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cubmods">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/cubmods.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Massimo Pierini.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>